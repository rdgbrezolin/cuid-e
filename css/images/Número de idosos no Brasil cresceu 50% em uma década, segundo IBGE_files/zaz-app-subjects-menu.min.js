/*! zaz-app-subjects-menu - v2.0.2 - 29/05/2018 -- 6:48pm */
zaz.use(function(pkg){"use strict";pkg.require(["dictFactory"],function(dicFactory){dicFactory.create({name:"SubjectsMenuFutball",version:"1.0.0",langs:{pt:{is:"É",am:"Sou",is_fan:"É Torcedor?",i_am_fan:"Sou torcedor!",quick_access:"Acesso rápido: Aqui você vê as novidades do seu time em qualquer lugar do Terra"},es:{is:"¿Es",am:"¡Soy",is_fan:"¿Es hincha?",i_am_fan:"¡Soy hincha!",quick_access:"Acceso rápido: Aquí puedes ver las novedades al momento en cualquier lugar de Terra"},en:{}}}),dicFactory.create({name:"SubjectsMenuHoroscope",version:"1.0.0",langs:{pt:{is:"É",am:"Sou",is_fan:"É Torcedor?",i_am_fan:"Sou torcedor!",quick_access:"Acesso rápido: Aqui você vê as novidades do seu time em qualquer lugar do Terra"},es:{is:"¿Eres",am:"¡Soy",is_fan:"¿Es hincha?",i_am_fan:"¡Soy hincha!",quick_access:"Acceso rápido: Aquí puedes ver las novedades al momento en cualquier lugar de Terra"},en:{}}})})}),zaz.use(function ZazAppSubjectsMenu(pkg){"use strict";var console=pkg.console,require=pkg.require,define=pkg.define,PUBLIC_STATIC=null;require(["appFactory"],function(appFactory){var PRIVATE={};appFactory.create({name:"ZazAppSubjectsMenu",version:"2.0.2",docs:"http://github.tpn.terra.com/pages/terra/zaz-app-zaz-app-subjects-menu",source:"http://github.tpn.terra.com/Terra/zaz-app-zaz-app-subjects-menu",description:"Just another app",tests:"http://s1.trrsf.com/fe/zaz-app-zaz-app-subjects-menu/tests/index.htm?zaz[env]=tests",dependencies:["Request","dict.SubjectsMenuFutball","dict.SubjectsMenuHoroscope","mod.notificationsHelper"],dictionaries:["SubjectsMenuFutball","SubjectsMenuHoroscope"],templates:{buttom:'<div class="zaz-app-subjects-menu__item"><a href="javascript:void(0)" title="${ textAnswer }" class="buttom-rounded ${ classHoroscope }"><div class="buttom-rounded__content"><div class="buttom-rounded__unchecked-text"><div class="buttom-rounded__check checked icon icon-16 icon-check-light"></div><div class="buttom-rounded__text">${ textAsk }</div></div><div class="buttom-rounded__checked-text"><div class="buttom-rounded__check icon icon-16 icon-check-green"></div><div class="buttom-rounded__text">${ textAnswer }</div></div></div></a></div>',options:'{% if(mobile) %}<div class="zaz-app-subjects-menu__item-options-mobile"><div class="arrow-down"></div><div class="options-menu-tooltip">{% if(twitter) %}<a href="${ twitterUrl }" class="option-menu twitter" ts.idz="subject_twitter"><span class="twitter24"></span>${ twitterName }</a>{% endif %}</div></div>{% else %}<div class="zaz-app-subjects-menu__item-options">{% if(twitter) %}<a href="${ twitterUrl }" class="option-menu twitter sprite" ts.idz="subject_twitter"><div class="option-menu__tooltip twitter">${ twitterName }</div></a>{% endif %}</div>{% endif %}'},expects:{},extendable:{},setup:function(__static,__proto,__shared){var PUBLIC=this;PUBLIC_STATIC=__static,PRIVATE.objRequire=new __shared.dependencies.Request,PRIVATE.deviceType=pkg.context.platform.getType().match("mob"),PRIVATE.renderTeam=function(container){var buttom,team,tooltip,es,sou,dictFutball=new __shared.dependencies["dict.SubjectsMenuFutball"];if(container.style.display="block",window.trr.contextData.menu.apelido?(es=dictFutball.get("is")+" "+window.trr.contextData.menu.apelido+"?",sou=dictFutball.get("am")+" "+window.trr.contextData.menu.apelido+"!"):(es=dictFutball.get("is_fan"),sou=dictFutball.get("i_am_fan")),!buttom){var tplData={mobile:PRIVATE.deviceType,textAnswer:sou,textAsk:es,classHoroscope:""};buttom=PRIVATE.renderButton(container,tplData)}if(buttom){var _updateSoccerTeam=function(myTeam){var btnTextEs=buttom.querySelector(".buttom-rounded__unchecked-text .buttom-rounded__text"),btmTextSou=buttom.querySelector(".buttom-rounded__checked-text .buttom-rounded__text"),btmCheckGray=buttom.querySelector(".checked-gray16"),btmCheckGreen=buttom.querySelector(".checked-green16");myTeam&&myTeam.userTeam&&myTeam.userTeam.teamId===container.htmlDataset("idMusaTeam")?(buttom.setAttribute("data-select",!0),buttom.setAttribute("ts.idz","nav_teamfavorite_delete"),buttom.setAttribute("title",sou),buttom.getClassList().remove("unchecked"),buttom.getClassList().add("checked")):(buttom.setAttribute("ts.idz","nav_teamfavorite_select"),buttom.setAttribute("title",es),buttom.getClassList().remove("checked"),buttom.getClassList().add("unchecked"),buttom.removeAttribute("data-select"))};pkg.context.user.at("myTeam",function(myTeam){_updateSoccerTeam(myTeam)}),pkg.context.user.get("myTeam",function(myTeam){_updateSoccerTeam(myTeam)}),buttom.addEventListener("click",function(){return buttom.getAttribute("data-select")?void PRIVATE.removeTeam():void(team?(PRIVATE.save(team),team=null):PRIVATE.objRequire.get({url:window.top.location.protocol+"//"+window.top.location.hostname+"/cengine/musa-api/profile-contents?id="+container.htmlDataset("idMusaTeam")+"&lang=pt-BR",responseType:"json",success:function(data){team=data.root.result.profiles[0];var teamId=team.id;team.shield=container.htmlDataset("shield"),team.contents.filter(function(element){12==element.id_content&&PRIVATE.testLocale(element.name_locale)&&(team.content=element)}),pkg.context.user.get("myTeam",function(oldTeam){if(oldTeam&&oldTeam.userTeam&&oldTeam.userTeam.teamId){var country=pkg.context.page.getCountry(),segmentsRemove=country+"_matches_"+oldTeam.userTeam.teamId,segmentsAdd=country+"_matches_"+teamId;pkg.context.user.get("userArea",function(userArea){userArea.FirebaseToken&&(__shared.dependencies.mod.notificationsHelper.postSegments("segments_remove",segmentsRemove,userArea.FirebaseToken,"sw-myteammatches","fcm").then(function(){console.log("postSegments segmento time antigo removido com sucesso")}),userArea.notifications&&userArea.notifications.myteammatches&&__shared.dependencies.mod.notificationsHelper.postSegments("segments_add",segmentsAdd,userArea.FirebaseToken,"sw-myteammatches","fcm").then(function(){console.log("postSegments segmento time novo adicionado com sucesso")}))})}}),PRIVATE.save(team),team=null},complete:function(argument){console.log(argument)}}))})}},PRIVATE.save=function(sTeam){var objSave={name:sTeam.name,musa_id:sTeam.id,userTeam:{teamId:sTeam.id||"",teamName:sTeam.name||"",teamMnemonic:sTeam.mnemonic||"",teamCountry:pkg.context.page.getCountry()||"",teamUrl:"//"+pkg.context.page.host+pkg.context.page.path||"",iconURL:sTeam.shield}};"undefined"!=typeof sTeam.content&&(objSave.channel_id=sTeam.content.url_content||"",objSave.userTeam.teamChannelId=sTeam.content.url_content||""),pkg.context.user.set("myTeam",objSave)},PRIVATE.saveSign=function(sign){pkg.context.user.set("horoscope",sign||"")},PRIVATE.removeTeam=function(){pkg.context.user.set("myTeam","")},PRIVATE.removeSign=function(){pkg.context.user.set("horoscope","")},PRIVATE.renderButton=function(container,tplData){var buttom=container.querySelector(".zaz-app-subjects-menu .buttom-rounded"),renderedButton=PUBLIC.templates.render("buttom",tplData);container.appendChild(renderedButton);var btmTextSize=container.querySelector(".buttom-rounded__checked-text .buttom-rounded__text").offsetWidth+"px";return container.querySelector(".buttom-rounded__text").style.width=btmTextSize,buttom=container.querySelector(".zaz-app-subjects-menu .buttom-rounded"),buttom},PRIVATE.renderOptions=function(container){var twitter=pkg.context.page.get("twitter"),twitterName="",twitterUrl="";"undefined"!=typeof twitter&&(twitter=twitter.split(";"),twitterName=twitter[0],twitterUrl=twitter[1],twitter=!0);var tplData={mobile:PRIVATE.deviceType,twitter:twitter,twitterName:twitterName,twitterUrl:twitterUrl};if("mob"==pkg.context.platform.getType()&&twitter===!0){var wrapper=container.querySelector(".zaz-app-subjects-menu__wrapper").parentNode;wrapper.parentNode.insertBefore(PUBLIC.templates.render("options",tplData),wrapper.nextSibling)}else twitter===!0&&container.appendChild(PUBLIC.templates.render("options",tplData));if("mob"==pkg.context.platform.getType()&&twitter===!0){var menuOptionsMobile=container.querySelector(".zaz-app-subjects-menu__item-options-mobile"),arrowDown=menuOptionsMobile.querySelector(".arrow-down"),tooltip=menuOptionsMobile.querySelector(".options-menu-tooltip");tooltip&&arrowDown&&arrowDown.addEventListener("click",function(){tooltip.style.display="block"==tooltip.style.display?"none":"block"},!1)}},PRIVATE.renderHoroscope=function(container){var buttom,dictHoroscope=new __shared.dependencies["dict.SubjectsMenuHoroscope"],textAsk=dictHoroscope.get("is")+" "+pkg.context.page.get("signName")+"?",textAnswer=dictHoroscope.get("am")+" "+pkg.context.page.get("signName")+"!",classHoroscope="";if("es"==pkg.context.page.get("lang")&&(classHoroscope="btn-Horoscope"),!buttom){var tplData={mobile:PRIVATE.deviceType,textAnswer:textAnswer,textAsk:textAsk,classHoroscope:classHoroscope};buttom=PRIVATE.renderButton(container,tplData),pkg.context.user.get("horoscope",function(horoscope){PRIVATE.setStateButtomHoroscope(buttom,horoscope||null)}),pkg.context.user.at("horoscope",function(horoscope){PRIVATE.setStateButtomHoroscope(buttom,horoscope||null)}),buttom.addEventListener("click",function(){return buttom.getAttribute("data-select")?void PRIVATE.removeSign():void PRIVATE.saveSign(pkg.context.page.get("signID"))})}},PRIVATE.testLocale=function(full){var min=pkg.context.page.getCountry(),countries={ar:"Argentina",br:"Brasil",cl:"Chile",co:"Colômbia",mx:"México",pe:"Perú",eu:"Estados Unidos",es:"Espanha"};return min in countries&&countries[min]==full?!0:!1},PRIVATE.queryTeam=function(cont,idMusaTeam){PRIVATE.objRequire.get({url:window.top.location.protocol+"//"+window.top.location.hostname+"/cengine/musa-api/profile-contents?id="+idMusaTeam+"&lang=pt-BR",responseType:"json",success:function(data){var qTeam=data.root.result.profiles[0],rendered=!1;qTeam.contents.filter(function(element){return 12==element.id_content&&PRIVATE.testLocale(element.name_locale)?(PRIVATE.renderTeam(cont,idMusaTeam),void(rendered=!0)):void 0}),rendered||PRIVATE.renderTeam(cont,idMusaTeam)},complete:function(argument){console.log(argument)}})},PRIVATE.setStateButtomHoroscope=function(buttom,signID){pkg.context.page.get("signID")===signID?(buttom.setAttribute("data-select",!0),buttom.setAttribute("ts.idz","nav_teamfavorite_delete"),buttom.getClassList().remove("unchecked"),buttom.getClassList().add("checked")):(buttom.setAttribute("ts.idz","nav_teamfavorite_select"),buttom.getClassList().remove("checked"),buttom.getClassList().add("unchecked"),buttom.removeAttribute("data-select"))}},init:function(data,__shared){var PUBLIC=this,containers=document.querySelectorAll(".zaz-app-subjects-menu"),renderType="FUTBALL",matchInfo=pkg.context.page.get("matchInfo");if(containers&&containers.length>0)if("open-menu"===containers[0].htmlDataset("context")&&(renderType=null,window.tga.event("menu-aberto","click",containers[0].querySelectorAll(".menu-item"))),"horoscope"===containers[0].htmlDataset("context")&&(renderType="HOROSCOPE"),"FUTBALL"===renderType)for(var i=0;i<containers.length;i++){var cont=containers[i],idMusaTeam=cont.htmlDataset("idMusaTeam");idMusaTeam&&PRIVATE.queryTeam(cont,idMusaTeam)}else"HOROSCOPE"===renderType&&PRIVATE.renderHoroscope(containers[0]);return PUBLIC},teardown:function(why,__static,__proto,__shared){}})})});