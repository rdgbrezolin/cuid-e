/*! zaz-app-cards - v1.0.0 - 05/06/2018 -- 6:24pm */
zaz.use(function appCards(pkg){"use strict";var console=pkg.console,require=pkg.require,define=pkg.define,PUBLIC_STATIC=null,STATIC={};pkg.factoryManager.get("app").create({name:"cards",version:"1.0.0",state:"ok",docs:"http://github.tpn.terra.com/pages/terra/cards",source:"http://github.tpn.terra.com/Terra/cards",description:"Just another app",tests:"http://s1.trrsf.com/fe/cards/tests/index.htm?zaz[env]=tests",dependencies:[],dictionaries:[],templates:{},setup:function(__static,__proto,__shared){var tempTemplates={"card-w2h2":"{% set hasImage = card['items'][0].image != None %}{% set className = '' %}{% set objReason = card|get_reasons %}{% set channelInfo = card|get_channel_info %}{% set cardHat = card|get_card_hat(context, cardInfo['size']) %}{% if cardInfo['sequence'] %}{% set className = 'card-'+ cardInfo['sequence'] %}{% endif %}{% if card.setBackground == True %}{% set className = className +' '+ card|get_channel_color(context['lang']) %}{% endif %}{% if card['items'][0].fullTitle and card['items'][0].fullTitle != '' %}{% set cardTitle = card['items'][0].fullTitle %}{% else %}{% set cardTitle = card['items'][0].title %}{% endif %}{% if card['items'][0].visited %}{% set visited = 'data-visited=\"true\"' %}{% else %}{% set visited = '' %}{% endif %}{% if card['items'][0].url|is_internal_domain %}{% set target = '_top' %}{% set noopener = '' %}{% else %}{% set target = '_blank' %}{% set noopener = 'rel=\"noopener\"' %}{% endif %}{% if card['source'] and card['source'].name %}{% set sourceName = card['source'].name %}{% else %}{% set sourceName = '' %}{% endif %}{% if card['source'] and card['source'].types %}{% set sourceTypes = card['source'].types|join(',') %}{% else %}{% set sourceTypes = '' %}{% endif %}<div class=\"cards {{ cardInfo['size'] }} {{ className }}\" id=\"{{ card['items'][0].id }}\" {{ visited }} data-size=\"w2h2\" data-card-sequece=\"{{ cardInfo.sequence }}\" data-type=\"{{ card.type }}\" data-tgmkey=\"{{ card.tgmKey }}\" data-reason=\"{{ objReason['reason'] }}\" data-reason-detail=\"{{ objReason['reasonDetail'] }}\" data-reason-score=\"{{ objReason['score'] }}\" data-channel-info=\"{{ channelInfo }}\" title=\"{{ cardTitle|e }}\" data-source-name=\"{{ sourceName }}\" data-source-types=\"{{ sourceTypes }}\" data-ga=\"true\"><div class=\"container-essentials news {{ '' if hasImage else 'no-image' }}\">{% if hasImage %}<a href=\"{{ card['items'][0].url }}\" data-ts-sc=\"1\" target=\"{{target}}\" {{noopener}}><div class=\"news-image\">{{ card|get_image(context, cardInfo['size'], tableInfo.tableSequenceContent) }}{% if card.type == 'V' or card.type == 'EPL' %}<span class=\"icon-thumb icon-52 icon-play-white\"></span><div class=\"shadow\"></div>{% endif %}</div></a>{% endif %}<div class=\"news\"><div class=\"title\">{{ cardHat }}{% if hasImage %}<h3><a href=\"{{ card['items'][0].url }}\" data-ts-sc=\"1\" target=\"{{target}}\" {{noopener}} class=\"main-url text\">{{ cardTitle|truncate(70) }}</a></h3>{% else %}<h3><a href=\"{{ card['items'][0].url }}\" data-ts-sc=\"1\" target=\"{{target}}\" {{noopener}} class=\"main-url text\">{{ cardTitle|truncate(120) }}</a></h3>{% endif %}</div><div class=\"card-footer\">{% include \"_card-footer.html\" %}</div></div></div></div>","card-w2h1":"{% set hasImage = card['items'][0].image != None %}{% set className = '' %}{% set objReason = card|get_reasons %}{% set channelInfo = card|get_channel_info %}{% set cardHat = card|get_card_hat(context, cardInfo['size']) %}{% if cardInfo['sequence'] and cardInfo['insideGroup'] == False %}{% set className = 'card-'+ cardInfo['sequence'] %}{% set cardSequence = cardInfo['sequence'] %}{% endif %}{% if cardInfo['insideGroup'] %}{% set className = className + ' card-group' %}{% set cardSequence = 0 %}{% endif %}{% if cardInfo['lastChild'] %}{% set className = className + ' lastchild' %}{% endif %}{% if card.setBackground == True %}{% set className = className +' '+ card|get_channel_color(context['lang']) %}{% endif %}{% if card['items'][0].fullTitle and card['items'][0].fullTitle != '' %}{% set cardTitle = card['items'][0].fullTitle %}{% else %}{% set cardTitle = card['items'][0].title %}{% endif %}{% if card['items'][0].visited %}{% set visited = 'data-visited=\"true\"' %}{% else %}{% set visited = '' %}{% endif %}{% if card['items'][0].url|is_internal_domain %}{% set target = '_top' %}{% set noopener = '' %}{% else %}{% set target = '_blank' %}{% set noopener = 'rel=\"noopener\"' %}{% endif %}{% if card['source'] and card['source'].name %}{% set sourceName = card['source'].name %}{% else %}{% set sourceName = '' %}{% endif %}{% if card['source'] and card['source'].types %}{% set sourceTypes = card['source'].types|join(',') %}{% else %}{% set sourceTypes = '' %}{% endif %}<div class=\"cards {{ cardInfo['size'] }} {{ className }}\" id=\"{{ card['items'][0].id }}\" {{visited }} data-size=\"w2h1\" data-card-sequece=\"{{ cardSequence }}\" data-type=\"{{ card.type }}\" data-tgmkey=\"{{ card.tgmKey }}\" data-reason=\"{{ objReason['reason'] }}\" data-reason-detail=\"{{ objReason['reasonDetail'] }}\" data-reason-score=\"{{ objReason['score'] }}\" data-channel-info=\"{{ channelInfo }}\" title=\"{{ cardTitle|e }}\" data-source-name=\"{{ sourceName }}\" data-source-types=\"{{ sourceTypes }}\" data-ga=\"true\"><div class=\"container-essentials news {{ '' if hasImage else 'no-image' }}\">{% if hasImage %}<a href=\"{{ card['items'][0].url }}\" data-ts-sc=\"1\" target=\"{{target}}\" {{noopener}}><div class=\"news-image\">{{ card|get_image(context, cardInfo['size'], tableInfo.tableSequenceContent) }}{% if card.type == 'V' or card.type == 'EPL' %}<span class=\"icon-thumb icon-40 icon-play-white\"></span><div class=\"shadow\"></div>{% endif %}</div></a>{% endif %}<div class=\"news\"><div class=\"title\">{{ cardHat }}<h3><a href=\"{{ card['items'][0].url }}\" data-ts-sc=\"1\" target=\"{{target}}\" {{noopener}} class=\"main-url text\">{{ cardTitle|truncate(70) }}</a></h3></div><div class=\"card-footer\">{% include \"_card-footer.html\" %}</div></div></div></div>","card-w1h1":"{% set className = '' %}{% set objReason = card|get_reasons %}{% set channelInfo = card|get_channel_info %}{% set cardHat = card|get_card_hat(context, cardInfo['size']) %}{% if cardInfo['sequence'] and cardInfo['insideGroup'] == False %}{% set className = 'card-'+ cardInfo['sequence'] %}{% set cardSequence = cardInfo['sequence'] %}{% endif %}{% if cardInfo['insideGroup'] %}{% set className = className + ' card-group' %}{% set cardSequence = 0 %}{% endif %}{% if cardInfo['lastChild'] %}{% set className = className + ' lastchild' %}{% endif %}{% if card.setBackground == True %}{% set className = className +' '+ card|get_channel_color(context['lang']) %}{% endif %}{% if card['items'][0].fullTitle and card['items'][0].fullTitle != '' %}{% set cardTitle = card['items'][0].fullTitle %}{% else %}{% set cardTitle = card['items'][0].title %}{% endif %}{% if card['items'][0].visited %}{% set visited = 'data-visited=\"true\"' %}{% else %}{% set visited = '' %}{% endif %}{% if card['items'][0].url|is_internal_domain %}{% set target = '_top' %}{% set noopener = '' %}{% else %}{% set target = '_blank' %}{% set noopener = 'rel=\"noopener\"' %}{% endif %}{% if card['source'] and card['source'].name %}{% set sourceName = card['source'].name %}{% else %}{% set sourceName = '' %}{% endif %}{% if card['source'] and card['source'].types %}{% set sourceTypes = card['source'].types|join(',') %}{% else %}{% set sourceTypes = '' %}{% endif %}{% set iconHTML = '' %}{% if card.type == 'V' or card.type == 'EPL' %}{% set iconHTML = '<span class=\"icon icon-16 icon-camera\"></span>' %}{% endif %}<div class=\"cards {{ cardInfo['size'] }} {{ className }}\" id=\"{{ card['items'][0].id }}\" {{visited }} data-size=\"w1h1\" data-card-sequece=\"{{ cardSequence }}\" data-type=\"{{ card.type }}\" data-tgmkey=\"{{ card.tgmKey }}\" data-reason=\"{{ objReason['reason'] }}\" data-reason-detail=\"{{ objReason['reasonDetail'] }}\" data-reason-score=\"{{ objReason['score'] }}\" data-channel-info=\"{{ channelInfo }}\" title=\"{{ cardTitle|e }}\" data-source-name=\"{{ sourceName }}\" data-source-types=\"{{ sourceTypes }}\" data-ga=\"true\"><div class=\"container-essentials news\"><div class=\"news\"><div class=\"title\">{{ cardHat }}<h3><a href=\"{{ card['items'][0].url }}\" data-ts-sc=\"1\" target=\"{{target}}\" {{noopener}} class=\"main-url text\">{{iconHTML}}{{ cardTitle|truncate(70) }}</a></h3></div><div class=\"card-footer\">{% include \"_card-footer.html\" %}</div></div></div></div>",blog:"{% set objReason = card|get_reasons %}{% set author = card['items'][0].subTitle %}{% if author == None or author == '' %}{% if card['items'][0]['configs'] and card['items'][0]['configs']['author'] %}{% set author = card['items'][0]['configs']['author'] %}{% else %}{% set author = '' %}{% endif %}{% endif %}{% if card['items'][0].fullTitle and card['items'][0].fullTitle != '' %}{% set cardTitle = card['items'][0].fullTitle %}{% else %}{% set cardTitle = card['items'][0].title %}{% endif %}<div class=\"cards {{ cardInfo.size }} card-{{ cardInfo.sequence }}\" id=\"{{ card.id }}\" data-type=\"B\" data-tgmkey=\"{{ card.tgmKey }}\" data-reason=\"{{ objReason['reason'] }}\" data-reason-detail=\"{{ objReason['reasonDetail'] }}\" data-reason-score=\"{{ objReason['score'] }}\" title=\"{{ cardTitle|e }}\" data-ga=\"true\"><div class=\"container-essentials no-image blog\"><a href=\"{{ card['items'][0].configs.additional_url }}\" data-ts-sc=\"1\"><div class=\"card-header\"><div class=\"image\">{{ card|get_image_blog }}</div><div class=\"name\"><i>{{ author }}</i></div></div></a><a href=\"{{ card['items'][0].url }}\" title=\"{{ card['items'][0].fullTitle }}\" data-ts-sc=\"1\"><div class=\"card-content\"><span class=\"icon left quote_brandig40\"></span>{{ card['items'][0].title }}<span class=\"icon right quote_gray_lighter40\"></span></div></a><div class=\"card-footer\">{% include \"_card-footer.html\" %}</div></div></div>",_card_footer:"{% set hideShareText = False %}{% set stamp = card|get_stamp_card(context, cardInfo['size']) %}{% if stamp %}{% if (hasImage and (cardInfo['size'] == 'w2h1' or cardInfo['size'] == 'w2h1 flex' or cardInfo['size'] == 'w4h1 flex')) or cardInfo['size'] == 'w1h1' %}{% set hideShareText = (stamp.typeStamp != None)%}{% endif %}{% endif %}<div class=\"published-date\"><span class=\"text\" title=\"{{ card['items'][0]['firstPublishedDate']|get_date_card_complete(dictionary, context) }}\">{{ card['items'][0]['firstPublishedDate']|get_date_card(dictionary, context) }}</span></div>{% include \"_stamp.html\" %}",_stamp:'{% if stamp %}{% if stamp.typeStamp == \'SPONSOR\' %}{% if stamp.img%}<div class="stamp-card sponsor-logo"><a target="_blank" rel="noopener" href="{{ stamp.url }}">{{ stamp.img }}</a></div>{% else %}<div class="stamp-card sponsor">{{ dictionary.sponsoredBy }} {{ stamp.text }}</div>{% endif %}{% elif stamp.typeStamp == \'AD\' %}<div class="stamp-card ad" style="display:none"></div>{% elif stamp.typeStamp == \'TEAM\' %}<div class="stamp-card team">{% if stamp.teamURL%}<a href="{{ stamp.teamURL }}">{%endif%}<div class="icon icon-24 team--{{ stamp.teamChannelID }}"></div>{% if stamp.teamURL%}</a>{%endif%}</div>{% elif stamp.typeStamp == \'GEOLOC\' %}<div class="stamp-card flag"><span class="{{ stamp.flagName }}"></span></div>{% elif stamp.typeStamp == \'SOCIAL\' %}<div class="stamp-card buzz"><div class="trend-tip"><div class="sprite-icons-card buzz-tooltip-arrow"></div><span>{{ dictionary.trendTip }}</span></div><span class="trend-text">{{ dictionary.trend }}</span><div class="icon icon-24 icon-trending"></div></div>{% endif %}{% endif %}'},patt,res,includeName,template;for(var x in tempTemplates)tempTemplates.hasOwnProperty(x)&&(patt=new RegExp('(include) (".[^"]+")',"g"),res=patt.exec(tempTemplates[x]),res?(includeName=res[2].replace(/\.html|\"/g,"").replace(/\-/g,"_"),template=tempTemplates[x].replace(res[2],includeName)):template=tempTemplates[x],__proto.templates.create(x,template))},init:function(data,__shared){var PUBLIC=this,PRIVATE={};PRIVATE.uaGA={br:1,ar:2,cl:3,co:4,ec:10,mx:5,es:8,pe:6,us:7,ve:11,nd:12},window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,window.ga("create","UA-54936151-"+PRIVATE.uaGA[pkg.context.page.get("country")]),window.ga("require","ec"),PRIVATE.istouchdevice=1==("ontouchstart"in window?1:0),PRIVATE.objTgmKeyStamp=null,PRIVATE.objContentStatus=null;var stampTgmkeys=pkg.context.page.get("tagmanStampFeed");return stampTgmkeys&&stampTgmkeys.length>0&&(PRIVATE.objTgmKeyStamp={},PRIVATE.objTgmKeyStamp.P=stampTgmkeys.slice(0),PRIVATE.objTgmKeyStamp.E=stampTgmkeys.slice(0)),PRIVATE.loadContentStatus=function(objCard){var divContainer=objCard.querySelector(".container-essentials"),classSize=objCard.htmlDataset("size"),backgroundCard="default-white",imageTag=objCard.querySelector(".news-image img");null===PRIVATE.objContentStatus?pkg.require(["app.zazAppContentstatus"],function(ContentStatus){PRIVATE.objContentStatus=new ContentStatus,PRIVATE.objContentStatus.createCheckEssentials(divContainer,classSize,backgroundCard,imageTag)},function(e){console.log("Error ContentStatus ---------->",e)}):PRIVATE.objContentStatus.createCheckEssentials(divContainer,classSize,backgroundCard,imageTag)},PUBLIC.bindEvents=function(cardList){if(cardList&&cardList.length>0)for(var i=0;i<cardList.length;i++)"V"===cardList[i].htmlDataset("type")&&PRIVATE.addCardEmbed(cardList[i]),"P"===cardList[i].htmlDataset("type")&&"true"==cardList[i].htmlDataset("ga")&&PRIVATE.regMetricsPremium(cardList[i]),("N"===cardList[i].htmlDataset("type")||"V"===cardList[i].htmlDataset("type")||"G"===cardList[i].htmlDataset("type")||"S"===cardList[i].htmlDataset("type"))&&(PRIVATE.addShareActions(cardList[i]),"true"==cardList[i].htmlDataset("ga")&&PRIVATE.regMetrics(cardList[i])),("B"===cardList[i].htmlDataset("type")||"EPL"===cardList[i].htmlDataset("type"))&&"true"==cardList[i].htmlDataset("ga")&&PRIVATE.regMetrics(cardList[i]),"S"===cardList[i].htmlDataset("type")&&"iPhone"==pkg.context.platform.get("device")&&PRIVATE.changeTargetLink(cardList[i]),"A"!==cardList[i].htmlDataset("type")&&cardList[i].htmlDataset("tgmkey")&&""!==cardList[i].htmlDataset("tgmkey")&&PRIVATE.loadStampAD(cardList[i]),cardList[i].htmlDataset("visited")&&PRIVATE.loadContentStatus(cardList[i])},PRIVATE.regMetricsPremium=function(objCard){var cards=objCard.querySelectorAll(".item-premium");if(cards)for(var i=0;i<cards.length;i++)PRIVATE.regMetrics(cards[i])},PRIVATE.regMetrics=function(objCard){var getMetricsTypes=function(s){function validateReason(s,c){return s.search(c)>=0?c:""}var reason="";return reason+=validateReason(s,"c"),reason+=validateReason(s,"e"),reason+=validateReason(s,"u"),reason+=validateReason(s,"p"),reason+=validateReason(s,"s"),reason+=validateReason(s,"g"),reason+=validateReason(s,"t"),reason+=validateReason(s,"a"),reason+=validateReason(s,"b"),reason+=validateReason(s,"f"),reason+=validateReason(s,"m"),reason+=validateReason(s,"o"),reason+=validateReason(s,"r"),reason+=validateReason(s,"v"),reason+=validateReason(s,"x"),reason+=validateReason(s,"n"),reason},getSourceTypes=function(objCard){var elemA,url,type="",sourceTypes=objCard.htmlDataset("sourceTypes");return elemA=objCard.querySelector(".main-url")||objCard,elemA&&elemA.href&&(url=elemA.href),sourceTypes=sourceTypes.split(","),PRIVATE.getIndexArray(sourceTypes,"PRT")!==!1&&url?type=PRIVATE.isInternalDomain(url)?"interno":"externo":PRIVATE.getIndexArray(sourceTypes,"SRC")!==!1&&(type="agencia"),type};objCard.addEventListener("mousedown",function(){var channel=[],siteID,cardReson="",source="",sourceType="",cardType="",cardTypes={N:"not",S:"not",V:"vid",EPL:"vid"},pageChannelInfo=[],channelInfo=objCard.htmlDataset("channelInfo");window.terra_info_channel&&(pageChannelInfo=window.terra_info_channel.split(".")),channelInfo&&(channelInfo=channelInfo.split("|"),channel=channelInfo[0].split("."),siteID=channelInfo[1]),objCard.htmlDataset("sourceName")&&(source=objCard.htmlDataset("sourceName")),objCard.htmlDataset("reason")&&(cardReson=getMetricsTypes(objCard.htmlDataset("reason"))),objCard.htmlDataset("sourceTypes")&&(sourceType=getSourceTypes(objCard)),objCard.htmlDataset("type")&&(cardType=cardTypes[objCard.htmlDataset("type")]),window.ga("ec:addProduct",{id:cardReson,name:objCard.title,dimension51:source,dimension65:channel.length>0?channel[1]:"",dimension66:channel.length>0?channel[2]:"",dimension67:sourceType,dimension69:cardType}),window.ga("ec:setAction","click");var CD={dimension1:pageChannelInfo.length>0?pageChannelInfo[1]:"",dimension2:pageChannelInfo.length>0?pageChannelInfo[2]:"",dimension3:window.terra_info_channeldetail,dimension4:"contenido_digital",dimension5:window.terra_stats_idCrtfc,dimension6:pkg.context.page.get("channelID"),dimension7:window.terra_info_type.toLowerCase(),dimension9:"terra"},pageTheme="default",reTheme=/user_theme=(\w+)/,userTheme=reTheme.exec(document.cookie);userTheme&&userTheme.length>1&&(pageTheme=userTheme[1]),CD.dimension52=pageTheme,navigator.connection&&(navigator.connection.type&&(CD.dimension57=navigator.connection.type),navigator.connection.downlinkMax&&(CD.dimension58=navigator.connection.downlinkMax),navigator.connection.downlink&&(CD.dimension60=navigator.connection.downlink),navigator.connection.rtt&&(CD.dimension61=navigator.connection.rtt),navigator.connection.effectiveType&&(CD.dimension62=navigator.connection.effectiveType),"saveData"in window.navigator.connection&&(CD.dimension63=navigator.connection.saveData.toString())),window.ga("send","event",""!==cardReson?"card-"+cardReson:"card","click",objCard.title,CD)})},PRIVATE.changeTargetLink=function(objCard){var listLinks=objCard.querySelectorAll('a[target="_blank"]');if(listLinks){var i,length=listLinks.length;for(i=0;length>i;i++)listLinks[i].target="_top"}},PRIVATE.getIndexArray=function(array,val){for(var i=0,j=array.length;j>i;i++)if(array[i]===val)return i;return!1},PRIVATE.loadStampAD=function(objCard){var tgmkey=objCard.htmlDataset("tgmkey"),tgmKeyPage=window.tgmKey,id="stamp-"+objCard.id,indexTgmKey=!1,typeCard="P"==objCard.htmlDataset("type")?"P":"E",objStamp=objCard.querySelector(".stamp-card.ad");if(!objStamp||!PRIVATE.objTgmKeyStamp)return!1;if(indexTgmKey=PRIVATE.getIndexArray(PRIVATE.objTgmKeyStamp[typeCard],tgmkey),indexTgmKey===!1)return!1;var tgmKeyStamp=PRIVATE.objTgmKeyStamp[typeCard][indexTgmKey]+".home";return tgmKeyStamp===tgmKeyPage?!1:(objStamp.id=id,void pkg.require(["mod.adManager"],function(AdManager){var objAdmanger=new AdManager;objAdmanger.stickAd({placeholder:document.getElementById(id),area:"home.selo",tgmkey:tgmkey}).then(function(meta){objStamp.style.display="block"},function(e){objStamp.style.display="none"})}))},PRIVATE.addCardEmbed=function(objCard){function getPlayer(event){event.stopPropagation(),event.preventDefault(),"w4h2"==objCard.htmlDataset("size")&&1280===window.G.conf.windowSize&&"square"!=hasClassSquare?(playerW=620,playerH=300):"w4h2"!=objCard.htmlDataset("size")||1280==window.G.conf.windowSize&&"square"!=hasClassSquare||(playerW=300,playerH=300);var playerTgmkey="";return objCard.htmlDataset("tgmKey")&&(playerTgmkey=objCard.htmlDataset("tgmKey")),PRIVATE.loadEmbedVideo(objVideo,id,playerTgmkey),objClick.removeEventListener("click",getPlayer),!1}var playerW,playerH,id=objCard.id,idPlayerEmbed="player-embed-"+id,objVideo=null,objClick=null,hasClassSquare=objCard.className.search("square")>=0;return"w4h2"===objCard.htmlDataset("size")&&(objVideo=objCard.querySelector(".container-essentials"),objClick=objCard.querySelector(".container-essentials a")),objVideo?(objVideo.id=idPlayerEmbed,objVideo.className+=" player-embed",void(objClick&&objClick.addEventListener("click",getPlayer))):!1},PRIVATE.addShareActions=function(objCard){function openSocialPopUp(event){var cardURL=objCard.querySelector(".main-url").href,socialClick=event.target.className,popupURL,networkName,networkMetric;if(-1!=socialClick.indexOf("facebook"))popupURL="http://www.facebook.com/sharer/sharer.php?u="+cardURL,networkName="Facebook",networkMetric="fb_mesa";else if(-1!=socialClick.indexOf("twitter")){var title=encodeURI(objCard.querySelector(".text").innerHTML);popupURL="https://twitter.com/intent/tweet?text="+title+"&url="+cardURL,networkName="Twitter",networkMetric="tw_mesa"}else-1!=socialClick.indexOf("google")&&(popupURL="https://plus.google.com/share?url="+cardURL,networkName="+Plus",networkMetric="gp_mesa");if(networkName){window.open(popupURL,"_blank","width=520,height=420",networkName);var tablescounter=0,cardposition=0,objParent=objCard.parentNode;objParent&&-1===objParent.className.search(".table-gambit")&&(objParent=objParent.parentNode),objParent.className.search(".table-gambit")>=0&&(tablescounter=objParent.htmlDataset("area")),cardposition=objCard.htmlDataset("cardSequece");try{"undefined"!=typeof window.terra_stats_regClick&&window.terra_stats_regClick(cardURL,"com;"+networkMetric+";"+tablescounter+"_card;"+cardposition)}catch(err){window.console.log("Metrics Fail: "+err.message+" - "+cardURL+"com;"+networkMetric+";"+tablescounter+"_card;"+cardposition)}}}var objClick=objCard.querySelector(".share");PRIVATE.istouchdevice&&objClick&&PRIVATE.mobileActionShare(objClick,objCard),objClick&&objClick.addEventListener("click",openSocialPopUp)},PRIVATE.mobileActionShare=function(objClick,objCard){objClick.addEventListener("click",function(){var className=objClick.className;if(-1===className.search("show-share"))objClick.className+=" show-share",objClick.querySelector(".share-text.hide")&&(objCard.querySelector(".stamp-card").style.display="none");else{objClick.className=objClick.className.replace("show-share","");var objStamp=objCard.querySelector(".stamp-card");objStamp&&(objStamp.style.display="block")}})},PRIVATE.loadEmbedVideo=function(objVideo,id,playerTmgkey){pkg.require(["app.player"],function(Player){var instancePlayers=new Player({videoId:parseInt(id),autoPlay:!0,isEmbedded:!1,clicked:!0,advertise:{enabled:!0,tgmKey:playerTmgkey},container:objVideo,metrics:{infoChannel:window.terra_info_channel,infoChannelDetail:window.terra_info_channeldetail,idCertifica:window.terra_stats_idCrtfc}});instancePlayers.api.setupTransition(Player.RELATED_LIST),instancePlayers.events.on("nextVideo",function(nextVideoObj){instancePlayers.destroy(),PRIVATE.loadEmbedVideo(objVideo,nextVideoObj.videoId,playerTmgkey)})})},PUBLIC.renderCard=function(json,cardInfo){PUBLIC.templates.engine.addFilter("get_reasons",PRIVATE.getReasons),PUBLIC.templates.engine.addFilter("get_channel_info",PRIVATE.getChannelInfo),PUBLIC.templates.engine.addFilter("get_card_hat",PRIVATE.getCardHat),PUBLIC.templates.engine.addFilter("get_stamp_card",PRIVATE.getStampCard),PUBLIC.templates.engine.addFilter("get_image",PRIVATE.getImage),PUBLIC.templates.engine.addFilter("get_image_blog",PRIVATE.getImage),PUBLIC.templates.engine.addFilter("get_channel_color",PRIVATE.getChannelColor),PUBLIC.templates.engine.addFilter("get_date_card_complete",PRIVATE.getDateCardComplete),PUBLIC.templates.engine.addFilter("get_date_card",PRIVATE.getDateCard),PUBLIC.templates.engine.addFilter("is_internal_domain",PRIVATE.isInternalDomain);var elemCard=PUBLIC.templates.render("card-"+cardInfo.size,{card:json,cardInfo:cardInfo,context:{lang:pkg.context.page.get("lang"),channelPath:pkg.context.page.get("channelPath"),stampTgmkeys:pkg.context.page.get("tagmanStampFeed"),channelID:pkg.context.page.get("channelID"),country:pkg.context.page.get("country")}});return elemCard&&PUBLIC.bindEvents([elemCard.firstElementChild]),elemCard},PRIVATE.isInternalDomain=function(url){return url&&(url.search("www.terra.com.br")>-1||url.search("tpn.terra.com")>-1)},PRIVATE.getReasons=function(json){var objReason={reason:"",reasonDetail:""};if(json.croupier&&json.croupier.reasons){for(var k in json.croupier.reasons)json.croupier.reasons.hasOwnProperty(k)&&(objReason.reason+=k);if(json.croupier.reasons.p&&json.croupier.reasons.p.segments)objReason.reasonDetail=json.croupier.reasons.p.segments;else if(json.croupier.reasons.x&&json.croupier.reasons.x.segments)objReason.reasonDetail=json.croupier.reasons.x.segments;else if(json.croupier.reasons.g&&json.croupier.reasons.g.location){var objLocation=json.croupier.reasons.g.location;objReason.reasonDetail=objLocation.country,objLocation.state&&(objReason.reasonDetail+="/"+objLocation.state),objLocation.city&&(objReason.reasonDetail+="/"+objLocation.city)}else json.croupier.reasons.f&&json.croupier.reasons.f.position&&(objReason.reasonDetail=json.croupier.reasons.f.position)}return objReason},PRIVATE.getMainChannel=function(jsonItem){var channelItem;if(jsonItem.channels&&jsonItem.channels.length>0&&(channelItem=jsonItem.channels[0],jsonItem.channels.length>1))for(var i=0;i<jsonItem.channels.length;i++)if(jsonItem.channels[i].usedInURL){channelItem=jsonItem.channels[i];break}return channelItem},PRIVATE.getChannelInfo=function(json){var jsonItem,channelItem,channelInfo="";return json&&json.items&&json.items.length>0&&(jsonItem=json.items[0],channelItem=PRIVATE.getMainChannel(jsonItem),channelItem&&(channelItem.metricsChannel||channelItem.metricsSiteId)&&(channelInfo=channelItem.metricsChannel?channelItem.metricsChannel:"",channelInfo+="|"+(channelItem.metricsSiteId?channelItem.metricsSiteId:""))),channelInfo},PRIVATE.getClassChannel=function(channelItem){var borderClass="default";if(channelItem)for(var channelNames={pt:["noticias","economia","esportes","diversao","vida-e-estilo","musica"],es:["noticias","economia","deportes","entretenimiento","vida-y-estilo","musica"],en:["news","economy","sports","entertainment","life-style","musica"],className:["news","economy","sport","entertainment","live-style","entertainment"]},objDict=channelNames[pkg.context.page.get("lang")],x=0;6>x;x++)if(channelItem.path.search(objDict[x])>=0){borderClass=channelNames.className[x];break}return borderClass},PRIVATE.getCardHat=function(json,context,classSize){var channelItem,jsonItem,channelClass="",title="",labelChannel="",classFlex="",className="",pathVideo=context.channelPath+".videos";return json&&json.items&&json.items[0]&&(jsonItem=json.items[0],channelItem=PRIVATE.getMainChannel(jsonItem)),classSize&&(classFlex=classSize.search("flex")>-1?"flex":"",classSize=classSize.split(" ")[0]),channelItem&&(channelClass=PRIVATE.getClassChannel(channelItem),channelItem.path!=context.channelPath&&channelItem.path!=pathVideo&&(className="hat gray",("w4h2"==classSize||"w2h4"==classSize&&"flex"!=classFlex)&&(className="hat"),className+=" hover-"+channelClass+" border-"+channelClass,channelItem.label&&(labelChannel=channelItem.label),""===labelChannel&&(labelChannel=channelItem.name),json.cartola&&json.cartola.label&&json.cartola.url?title='<h2><a href="'+json.cartola.url+'" class="'+className+'" data-ts-idz="hat">'+json.cartola.label+"</a></h2>":channelItem.url&&(title='<h2><a href="'+channelItem.url+'" class="'+className+'" data-ts-idz="hat">'+labelChannel+"</a></h2>"))),title},PRIVATE.getStampCard=function(json,context,size){var objStamp,channels,teamChannelID,teamURL,objLocation,flagName,cropImage,source,sourceName,typeCard="E",type=json.type;if(channels=json&&json.items&&json.items[0]&&json.items[0].channels?json.items[0].channels:[],"E"===type&&(typeCard="P"),context.stampTgmkeys&&PRIVATE.getIndexArray(context.stampTgmkeys,json.tgmKey))objStamp={typeStamp:"AD",tgmKey:json.tgmKey};else if("E"===typeCard&&json.croupier&&json.croupier.reasons)if(json.croupier.reasons.t){if(teamChannelID=json.croupier.reasons.t,teamChannelID!==context.channelID&&channels&&channels.length>0)for(var i=0;i<channels.length;i++)if(channels[i].id===teamChannelID){teamURL=channels[i].url;break}objStamp={typeStamp:"TEAM",teamChannelID:teamChannelID},teamURL&&(objStamp.teamURL=teamURL)}else json.croupier.reasons.g&&json.croupier.reasons.g.location?(objLocation=json.croupier.reasons.g.location,flagName="",!objLocation.country||context.country===objLocation.country.toLowerCase()&&"br"!==context.country||("br"==objLocation.country.toLowerCase()&&(flagName=objLocation.state?"icon icon-24 icon-flag-state-"+PRIVATE.getShortNameState(objLocation.state):"country-"+objLocation.country.toLowerCase()),objStamp={typeStamp:"GEOLOC",flagName:flagName})):json.croupier.reasons.s&&(objStamp={typeStamp:"SOCIAL"});return objStamp||!json.source||void 0!==json.source.partner&&json.source.partner!==!0||"w1h1"===size||(objStamp={typeStamp:"SPONSOR"},json.source.image?(cropImage=json.source.image.verticalCrop?json.source.image.verticalCrop:"/",source=json.source.image.url.replace("http://",""),sourceName=json.source.name?json.source.name:"",objStamp.img='<img src="https://p2.trrsf.com/image/fget/cf/fit-in/compose'+cropImage+"70/25/"+source+'" alt="'+sourceName+'">',objStamp.url=json.source.url?json.source.url:""):json.source.sponsor&&(objStamp.text=json.source.sponsor)),objStamp},PRIVATE.getShortNameState=function(fullName){var states={ACRE:"ac",ALAGOAS:"al",AMAPA:"ap",AMAZONAS:"am",BAHIA:"ba",CEARA:"ce","DISTRITO FEDERAL":"df","ESPIRITO SANTO":"es",GOIAS:"go",MARANHAO:"ma","MINAS GERAIS":"mg","MATO GROSSO DO SUL":"ms","MATO GROSSO":"mt",PARA:"pa",PARAIBA:"pb",PARANA:"pr",PERNAMBUCO:"pe",PIAUI:"pi","RIO DE JANEIRO":"rj","RIO GRANDE DO NORTE":"rn","RIO GRANDE DO SUL":"rs",RONDONIA:"ro",RORAIMA:"rr","SANTA CATARINA":"sc",SERGIPE:"se","SAO PAULO":"sp",TOCANTINS:"to"};return states[fullName]},PRIVATE.getIndexArray=function(array,val){for(var i=0,j=array.length;j>i;i++)if(array[i]===val)return i;return!1},PRIVATE.getImage=function(json,context,classSize,tableSequenceContent){var jsonItem,imageTag="",classCutImage=classSize.split("cut-image-");return classCutImage=2===classCutImage.length?classCutImage[1]:null,json&&json.items&&json.items[0]&&(jsonItem=json.items[0]),classSize=classSize.split(" "),classSize=classSize[0],"w2h2"==classSize?imageTag=PRIVATE.getCardImage(jsonItem,"h",300,170):"w2h1"==classSize?imageTag=PRIVATE.getCardImage(jsonItem,"s",140,140):"w4h1"==classSize?imageTag=PRIVATE.getCardImage(jsonItem,"s",140,140):"w2h4"==classSize?imageTag=PRIVATE.getCardImage(jsonItem,"v",300,400):"w4h2"==classSize&&(imageTag="square"===classCutImage?PRIVATE.getCardImage(jsonItem,"s",300,300):PRIVATE.getCardImage(jsonItem,"h",620,300)),imageTag},PRIVATE.getCardImage=function(jsonItem,typeCrop,w,h){var source,typeImage,sourceImage,cropImage="",alt="",smart="",quality="",imageTag=null;return typeCrop="v"===typeCrop?"verticalCrop":"h"===typeCrop?"horizontalCrop":"s"===typeCrop?"squareCrop":"","mob"===pkg.context.platform.get("type")&&(w>300&&(w=300),h>300&&(h=300)),jsonItem.image&&jsonItem.image.url&&w>0&&h>0&&(source=jsonItem.image.url.replace("http://",""),cropImage=jsonItem.image[typeCrop]?jsonItem.image[typeCrop]:"/",!jsonItem.image[typeCrop]&&(620==w&&300==h||300==w&&400==h)&&source.indexOf("images.terra.com")>-1&&(smart="smart/"),""===alt&&(alt=jsonItem.title),sourceImage="https://p2.trrsf.com/image/fget/cf"+cropImage+w+"/"+h+"/"+smart+quality+source,typeImage=source.split("."),"gif"===typeImage[typeImage.length-1]&&(sourceImage+="?fit=false"),imageTag='<img src="'+sourceImage+'" alt="'+alt+'">'),imageTag},PRIVATE.getChannelColor=function(json,lang){var jsonItem,channelItem,channelClass="";return json&&json.items&&json.items[0]&&(jsonItem=json.items[0],channelItem=PRIVATE.getMainChannel(jsonItem),channelItem&&(channelClass=PRIVATE.getClassChannel(channelItem))),channelClass},PRIVATE.getImageBlog=function(json){var url,img="";return json&&json.item&&json.items[0]&&json.items[0].image&&(url=json.items[0].image.url.replace("http://",""),img='<img src="https://p2.trrsf.com/image/fget/cf/42/42/'+url+'" alt="'+json.items[0].image.alt+'">'),img},PRIVATE.getDateCardComplete=function(){return""},PRIVATE.getDateCard=function(){return""},PUBLIC},teardown:function(why,__static,__proto,__shared){}})});