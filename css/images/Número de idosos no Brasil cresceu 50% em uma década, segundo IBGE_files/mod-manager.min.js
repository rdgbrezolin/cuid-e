!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){function noop(){}var process=module.exports={};process.nextTick=function(){var canSetImmediate="undefined"!=typeof window&&window.setImmediate,canPost="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(canSetImmediate)return function(f){return window.setImmediate(f)};if(canPost){var queue=[];return window.addEventListener("message",function(ev){var source=ev.source;if((source===window||null===source)&&"process-tick"===ev.data&&(ev.stopPropagation(),queue.length>0)){var fn=queue.shift();fn()}},!0),function(fn){queue.push(fn),window.postMessage("process-tick","*")}}return function(fn){setTimeout(fn,0)}}(),process.title="browser",process.browser=!0,process.env={},process.argv=[],process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")}},{}],2:[function(require,module,exports){module.exports=function(){return function(doc){"use strict";var FiF={core:{settings:{placeholder:"",fifsrc:"iframe.html",adsrc:null,adcode:null,width:"",height:"",callback:function(){}},buildFiF:function(config){var settings=FiF.core.settings=FiF.core.mergeObj(FiF.core.settings,config),d=doc,fifBody="",fifId="",idocContent="",iframeModel="",fifElement="",fif=null,fifHTML="",ph=null;if(settings.adcode){fifBody='<!DOCTYPE html><html><body style="background-color:transparent;" id="FiF_container"><script>'+settings.adcode+"</script></body></html>",fifId="fif_"+settings.placeholder,iframeModel='<iframe id="'+fifId+'" style="width:100%;height:100%;border:none" vspace="0" hspace="0" allowtransparency="true" scrolling="no" frameborder="no" marginwidth="0" marginheight="0"></iframe>';try{fifElement=d.getElementById(settings.placeholder),fifElement.innerHTML=iframeModel,"function"==typeof settings.callback&&settings.callback()}catch(error){FiF.core.debug.errors.push({HumanReadable:"Error appendind Iframe in placeholder",error:error})}fif=d.getElementById(fifId),idocContent=fif.contentWindow.document,idocContent.open(),idocContent.write(fifBody)}else if(settings.adsrc||settings.justrender){var width=settings.width?settings.width+"px":"100%",height=settings.height?settings.height+"px":"100%";fifHTML='<iframe id="fif_'+settings.placeholder+'" style="position:absolute" vspace="0" hspace="0" allowtransparency="true" scrolling="no" frameborder="no" marginwidth="0" marginheight="0"></iframe>',ph=d.getElementById(settings.placeholder),ph.innerHTML=fifHTML,fif=d.getElementById("fif_"+settings.placeholder),settings.meta&&(fif.meta=settings.meta),fif.src=settings.fifsrc,fif.setAttribute("seamless","seamless"),(fif.frameElement||fif).style.cssText="width: "+width+"; height: "+height+"; border: 0;margin:0;padding:0;borderWidth:0",settings.justrender||(fif.fif_src=settings.adsrc),fif.onload=function(){settings.callback()}}else FiF.core.debug.errors.push("Neither src or code for ad were provided. Fix that! I do not do magic!")},mergeObj:function(o,ob){var z,obj={};for(z in ob)ob.hasOwnProperty(z)&&(obj[z]=ob[z]);return obj},debug:{errors:[]}},pub:{create:function(new_settings){FiF.core.buildFiF(new_settings)},showErrors:function(){window.console&&console.log(FiF.core.debug.errors)},reloadAll:function(){var iframes=document.getElementsByTagName("iframe"),if_length=iframes.length,fifid=null,pattern="/^fif_/",i=0;for(i;if_length>i;i+1)fifid=iframes[i].id,pattern.test(fifid)&&FiF.pub.reload(fifid.replace("fif_",""))},reload:function(fifid){var iframe=document.getElementById("fif_"+fifid);iframe?document.getElementById("fif_"+fifid).contentDocument.location.reload(!0):FiF.core.debug.errors.push("Error trying to reload an Iframe. The Friendly Iframe with id fif_"+fifid+" was not found.")}}};return FiF.pub}(document)}()},{}],3:[function(require,module,exports){module.exports=function(){var PUBLIC_STATIC,STATIC={};return STATIC.instances={},STATIC.entries=[],STATIC.handlers=[],STATIC.EXP_SNIFF_FROM_USER_AGENT=/msie/i,STATIC.dumpingOnBrowsersConsole=!1,STATIC.LogEntry=function(instance,entry,details){this.id=instance.id,this.recordDate=new Date,this.instanceStartupDate=instance.startup,this.name="object"==typeof entry&&entry.name?entry.name:"checkpoint",this.details=details||("object"==typeof entry?entry:null),entry instanceof Error?(this.name=entry.name||"ApplicationError",this.message="[EXCEPTION : "+this.name+"] → "+entry.message):"object"==typeof entry?this.message=entry.message||window.JSON.stringify(entry):this.message=entry,this.friendlyDescription="["+this.id+("checkpoint"===this.name?"":" : "+this.name)+"] → "+this.message},STATIC.browsersConsoleHandler=function(message){var writingMethod,entry=this;if(window.console&&window.console.log){if(window.console[entry.name])writingMethod=entry.name;else switch(entry.name){case"warning":writingMethod=window.console.warn?"warn":"log";break;case"critical":writingMethod=window.console.error?"error":"log";break;default:writingMethod="log"}entry.details&&(entry.friendlyDescription+=" → [Details] ↓↓↓",STATIC.EXP_SNIFF_FROM_USER_AGENT.test(navigator.userAgent)&&window.JSON&&(entry.details=window.JSON.stringify(entry.details,null,!0))),window.console[writingMethod].apply?(window.console[writingMethod].apply(window.console,[entry.friendlyDescription]),entry.details&&window.console.log.apply(window.console,[entry.details])):(window.console[writingMethod](entry.friendlyDescription),entry.details&&window.console.log(entry.details))}},PUBLIC_STATIC=function(id){if("string"!=typeof id)throw"Invalid log id. You must pass a string to this constructor";if(STATIC.instances[id])return STATIC.instances[id];var PRIVATE={},PUBLIC=this;PRIVATE.entries=[],PRIVATE.handlers=[],PRIVATE.print=function(entry,handlers){var i;for(handlers=handlers instanceof Array?handlers:[handlers],i=0;i<handlers.length;i++)try{handlers[i].call(entry,entry.friendlyDescription)}catch(error){throw error.message="[Exception caught while handling a log entry] → "+error.message+" \nentry →"+window.JSON.stringify(entry),error}},PUBLIC.id=id,PUBLIC.startup=new Date,PUBLIC.write=function(entry,details){entry=new STATIC.LogEntry(PUBLIC,entry,details),PRIVATE.entries.push(entry),PRIVATE.handlers.length&&PRIVATE.print(entry,PRIVATE.handlers)},PUBLIC.setHandler=function(customHandler){if("function"!=typeof customHandler&&"BROWSERS_CONSOLE"!==customHandler)throw'Invalid log handler. You must pass a function as the only parameter. You can use de string "BROWSERS_CONSOLE" as well...';var i,entry;if("BROWSERS_CONSOLE"===customHandler){if(STATIC.dumpingOnBrowsersConsole)return;customHandler=STATIC.browsersConsoleHandler,PRIVATE.handlers.push(customHandler),STATIC.dumpingOnBrowsersConsole=!0}else PRIVATE.handlers.push(customHandler);for(i=0;i<PRIVATE.entries.length;i++)entry=PRIVATE.entries[i],PRIVATE.print(entry,customHandler);return PUBLIC},PUBLIC.reset=function(){PRIVATE.entries.length=0,PRIVATE.handlers.length=0}},PUBLIC_STATIC.reset=function(){var id,instance;for(id in STATIC.instances)STATIC.instances.hasOwnProperty(id)&&(instance=STATIC.instances[id],instance.reset());STATIC.instances={}},PUBLIC_STATIC}()},{}],4:[function(require,module,exports){!function(){AdManager.addFilter({name:"test",fn:function(){return"TEST"}}),AdManager.addFilter({name:"current-viewport",fn:function(){return AdManager.getCurrentViewport()}}),AdManager.addFilter({name:"ppiTag",fn:function(params){var szWindow=document.body.offsetWidth,ppiTag=null;return ppiTag=szWindow<=params[0]?"br.homepage.home.varejo800":szWindow<=params[1]?"br.homepage.home.varejo1024":"br.homepage.home.varejo1280"}})}()},{}],5:[function(require,module,exports){(function(process,global){!function(){if(!window.Promise){var define,requireModule,require,requirejs;!function(){var registry={},seen={};define=function(name,deps,callback){registry[name]={deps:deps,callback:callback}},requirejs=require=requireModule=function(name){function resolve(child){if("."!==child.charAt(0))return child;for(var parts=child.split("/"),parentBase=name.split("/").slice(0,-1),i=0,l=parts.length;l>i;i++){var part=parts[i];if(".."===part)parentBase.pop();else{if("."===part)continue;parentBase.push(part)}}return parentBase.join("/")}if(requirejs._eak_seen=registry,seen[name])return seen[name];if(seen[name]={},!registry[name])throw new Error("Could not find module "+name);for(var exports,mod=registry[name],deps=mod.deps,callback=mod.callback,reified=[],i=0,l=deps.length;l>i;i++)"exports"===deps[i]?reified.push(exports={}):reified.push(requireModule(resolve(deps[i])));var value=callback.apply(this,reified);return seen[name]=exports||value}}(),define("promise/all",["./utils","exports"],function(__dependency1__,__exports__){"use strict";function all(promises){var Promise=this;if(!isArray(promises))throw new TypeError("You must pass an array to all.");return new Promise(function(resolve,reject){function resolver(index){return function(value){resolveAll(index,value)}}function resolveAll(index,value){results[index]=value,0===--remaining&&resolve(results)}var promise,results=[],remaining=promises.length;0===remaining&&resolve([]);for(var i=0;i<promises.length;i++)promise=promises[i],promise&&isFunction(promise.then)?promise.then(resolver(i),reject):resolveAll(i,promise)})}var isArray=__dependency1__.isArray,isFunction=__dependency1__.isFunction;__exports__.all=all}),define("promise/asap",["exports"],function(__exports__){"use strict";function useNextTick(){return function(){process.nextTick(flush)}}function useMutationObserver(){var iterations=0,observer=new BrowserMutationObserver(flush),node=document.createTextNode("");return observer.observe(node,{characterData:!0}),function(){node.data=iterations=++iterations%2}}function useSetTimeout(){return function(){local.setTimeout(flush,1)}}function flush(){for(var i=0;i<queue.length;i++){var tuple=queue[i],callback=tuple[0],arg=tuple[1];callback(arg)}queue=[]}function asap(callback,arg){var length=queue.push([callback,arg]);1===length&&scheduleFlush()}var scheduleFlush,browserGlobal="undefined"!=typeof window?window:{},BrowserMutationObserver=browserGlobal.MutationObserver||browserGlobal.WebKitMutationObserver,local="undefined"!=typeof global?global:this,queue=[];scheduleFlush="undefined"!=typeof process&&"[object process]"==={}.toString.call(process)?useNextTick():BrowserMutationObserver?useMutationObserver():useSetTimeout(),__exports__.asap=asap}),define("promise/cast",["exports"],function(__exports__){"use strict";function cast(object){if(object&&"object"==typeof object&&object.constructor===this)return object;var Promise=this;return new Promise(function(resolve){resolve(object)})}__exports__.cast=cast}),define("promise/config",["exports"],function(__exports__){"use strict";function configure(name,value){return 2!==arguments.length?config[name]:void(config[name]=value)}var config={instrument:!1};__exports__.config=config,__exports__.configure=configure}),define("promise/polyfill",["./promise","./utils","exports"],function(__dependency1__,__dependency2__,__exports__){"use strict";function polyfill(){var es6PromiseSupport="Promise"in window&&"cast"in window.Promise&&"resolve"in window.Promise&&"reject"in window.Promise&&"all"in window.Promise&&"race"in window.Promise&&function(){var resolve;return new window.Promise(function(r){resolve=r}),isFunction(resolve)}();es6PromiseSupport||(window.Promise=RSVPPromise)}var RSVPPromise=__dependency1__.Promise,isFunction=__dependency2__.isFunction;__exports__.polyfill=polyfill}),define("promise/promise",["./config","./utils","./cast","./all","./race","./resolve","./reject","./asap","exports"],function(__dependency1__,__dependency2__,__dependency3__,__dependency4__,__dependency5__,__dependency6__,__dependency7__,__dependency8__,__exports__){"use strict";function Promise(resolver){if(!isFunction(resolver))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof Promise))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],invokeResolver(resolver,this)}function invokeResolver(resolver,promise){function resolvePromise(value){resolve(promise,value)}function rejectPromise(reason){reject(promise,reason)}try{resolver(resolvePromise,rejectPromise)}catch(e){rejectPromise(e)}}function invokeCallback(settled,promise,callback,detail){var value,error,succeeded,failed,hasCallback=isFunction(callback);if(hasCallback)try{value=callback(detail),succeeded=!0}catch(e){failed=!0,error=e}else value=detail,succeeded=!0;handleThenable(promise,value)||(hasCallback&&succeeded?resolve(promise,value):failed?reject(promise,error):settled===FULFILLED?resolve(promise,value):settled===REJECTED&&reject(promise,value))}function subscribe(parent,child,onFulfillment,onRejection){var subscribers=parent._subscribers,length=subscribers.length;subscribers[length]=child,subscribers[length+FULFILLED]=onFulfillment,subscribers[length+REJECTED]=onRejection}function publish(promise,settled){for(var child,callback,subscribers=promise._subscribers,detail=promise._detail,i=0;i<subscribers.length;i+=3)child=subscribers[i],callback=subscribers[i+settled],invokeCallback(settled,child,callback,detail);promise._subscribers=null}function handleThenable(promise,value){var resolved,then=null;try{if(promise===value)throw new TypeError("A promises callback cannot return that same promise.");if(objectOrFunction(value)&&(then=value.then,isFunction(then)))return then.call(value,function(val){return resolved?!0:(resolved=!0,void(value!==val?resolve(promise,val):fulfill(promise,val)))},function(val){return resolved?!0:(resolved=!0,void reject(promise,val))}),!0}catch(error){return resolved?!0:(reject(promise,error),!0)}return!1}function resolve(promise,value){promise===value?fulfill(promise,value):handleThenable(promise,value)||fulfill(promise,value)}function fulfill(promise,value){promise._state===PENDING&&(promise._state=SEALED,promise._detail=value,config.async(publishFulfillment,promise))}function reject(promise,reason){promise._state===PENDING&&(promise._state=SEALED,promise._detail=reason,config.async(publishRejection,promise))}function publishFulfillment(promise){publish(promise,promise._state=FULFILLED)}function publishRejection(promise){publish(promise,promise._state=REJECTED)}var config=__dependency1__.config,objectOrFunction=(__dependency1__.configure,__dependency2__.objectOrFunction),isFunction=__dependency2__.isFunction,cast=(__dependency2__.now,__dependency3__.cast),all=__dependency4__.all,race=__dependency5__.race,staticResolve=__dependency6__.resolve,staticReject=__dependency7__.reject,asap=__dependency8__.asap;config.async=asap;var PENDING=void 0,SEALED=0,FULFILLED=1,REJECTED=2;Promise.prototype={constructor:Promise,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(onFulfillment,onRejection){var promise=this,thenPromise=new this.constructor(function(){});if(this._state){var callbacks=arguments;config.async(function(){invokeCallback(promise._state,thenPromise,callbacks[promise._state-1],promise._detail)})}else subscribe(this,thenPromise,onFulfillment,onRejection);return thenPromise},"catch":function(onRejection){return this.then(null,onRejection)}},Promise.all=all,Promise.cast=cast,Promise.race=race,Promise.resolve=staticResolve,Promise.reject=staticReject,__exports__.Promise=Promise}),define("promise/race",["./utils","exports"],function(__dependency1__,__exports__){"use strict";function race(promises){var Promise=this;if(!isArray(promises))throw new TypeError("You must pass an array to race.");return new Promise(function(resolve,reject){for(var promise,i=0;i<promises.length;i++)promise=promises[i],promise&&"function"==typeof promise.then?promise.then(resolve,reject):resolve(promise)})}var isArray=__dependency1__.isArray;__exports__.race=race}),define("promise/reject",["exports"],function(__exports__){"use strict";function reject(reason){var Promise=this;return new Promise(function(resolve,reject){reject(reason)})}__exports__.reject=reject}),define("promise/resolve",["exports"],function(__exports__){"use strict";function resolve(value){var Promise=this;return new Promise(function(resolve,reject){resolve(value)})}__exports__.resolve=resolve}),define("promise/utils",["exports"],function(__exports__){"use strict";function objectOrFunction(x){return isFunction(x)||"object"==typeof x&&null!==x}function isFunction(x){return"function"==typeof x}function isArray(x){return"[object Array]"===Object.prototype.toString.call(x)}var now=Date.now||function(){return(new Date).getTime()};__exports__.objectOrFunction=objectOrFunction,__exports__.isFunction=isFunction,__exports__.isArray=isArray,__exports__.now=now}),requireModule("promise/polyfill").polyfill()}}()}).call(this,require("FWaASH"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{FWaASH:1}],6:[function(require,module,exports){module.exports=function(){!function(win,doc){function docHijack(p){var old=doc[p];doc[p]=function(v){return addListen(old(v))}}function addEvent(on,fn,self){return(self=this).attachEvent("on"+on,function(e){var e=e||win.event;e.preventDefault=e.preventDefault||function(){e.returnValue=!1},e.stopPropagation=e.stopPropagation||function(){e.cancelBubble=!0},fn.call(self,e)})}function addListen(obj,i){if(i=obj.length)for(;i--;)obj[i].addEventListener=addEvent;else obj.addEventListener=addEvent;return obj}win.addEventListener||(addListen([doc,win]),"Element"in win?win.Element.prototype.addEventListener=addEvent:(doc.attachEvent("onreadystatechange",function(){addListen(doc.all)}),docHijack("getElementsByTagName"),docHijack("getElementById"),docHijack("createElement"),addListen(doc.all)))}(window,document),function(window){function has(name){if("bug-string-char-index"==name)return"a"!="a"[0];var value,serialized='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}',isAll="json"==name;if(isAll||"json-stringify"==name||"json-parse"==name){if("json-stringify"==name||isAll){var stringify=JSON3.stringify,stringifySupported="function"==typeof stringify&&isExtended;if(stringifySupported){(value=function(){return 1}).toJSON=value;try{stringifySupported="0"===stringify(0)&&"0"===stringify(new Number)&&'""'==stringify(new String)&&stringify(getClass)===undef&&stringify(undef)===undef&&stringify()===undef&&"1"===stringify(value)&&"[1]"==stringify([value])&&"[null]"==stringify([undef])&&"null"==stringify(null)&&"[null,null,null]"==stringify([undef,getClass,null])&&stringify({a:[value,!0,!1,null,"\x00\b\n\f\r	"]})==serialized&&"1"===stringify(null,value)&&"[\n 1,\n 2\n]"==stringify([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==stringify(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==stringify(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==stringify(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==stringify(new Date(-1))}catch(exception){stringifySupported=!1}}if(!isAll)return stringifySupported}if("json-parse"==name||isAll){var parse=JSON3.parse;if("function"==typeof parse)try{if(0===parse("0")&&!parse(!1)){value=parse(serialized);var parseSupported=5==value.a.length&&1===value.a[0];if(parseSupported){try{parseSupported=!parse('"	"')}catch(exception){}if(parseSupported)try{parseSupported=1!==parse("01")}catch(exception){}}}}catch(exception){parseSupported=!1}if(!isAll)return parseSupported}return stringifySupported&&parseSupported}}var isProperty,forEach,undef,getClass={}.toString,isLoader="function"==typeof define&&define.amd,JSON3="object"==typeof exports&&exports;JSON3||isLoader?"object"==typeof JSON&&JSON?JSON3?(JSON3.stringify=JSON.stringify,JSON3.parse=JSON.parse):JSON3=JSON:isLoader&&(JSON3=window.JSON={}):JSON3=window.JSON||(window.JSON={});var isExtended=new Date(-0xc782b5b800cec);try{isExtended=-109252==isExtended.getUTCFullYear()&&0===isExtended.getUTCMonth()&&1===isExtended.getUTCDate()&&10==isExtended.getUTCHours()&&37==isExtended.getUTCMinutes()&&6==isExtended.getUTCSeconds()&&708==isExtended.getUTCMilliseconds()}catch(exception){}if(!has("json")){var functionClass="[object Function]",dateClass="[object Date]",numberClass="[object Number]",stringClass="[object String]",arrayClass="[object Array]",booleanClass="[object Boolean]",charIndexBuggy=has("bug-string-char-index");if(!isExtended)var floor=Math.floor,Months=[0,31,59,90,120,151,181,212,243,273,304,334],getDay=function(year,month){return Months[month]+365*(year-1970)+floor((year-1969+(month=+(month>1)))/4)-floor((year-1901+month)/100)+floor((year-1601+month)/400)};(isProperty={}.hasOwnProperty)||(isProperty=function(property){var constructor,members={};return(members.__proto__=null,members.__proto__={toString:1},members).toString!=getClass?isProperty=function(property){var original=this.__proto__,result=property in(this.__proto__=null,this);return this.__proto__=original,result}:(constructor=members.constructor,isProperty=function(property){var parent=(this.constructor||constructor).prototype;return property in this&&!(property in parent&&this[property]===parent[property])}),members=null,isProperty.call(this,property)});var PrimitiveTypes={"boolean":1,number:1,string:1,undefined:1},isHostType=function(object,property){var type=typeof object[property];return"object"==type?!!object[property]:!PrimitiveTypes[type]};if(forEach=function(object,callback){var Properties,members,property,forEach,size=0;(Properties=function(){this.valueOf=0}).prototype.valueOf=0,members=new Properties;for(property in members)isProperty.call(members,property)&&size++;return Properties=members=null,size?forEach=2==size?function(object,callback){var property,members={},isFunction=getClass.call(object)==functionClass;for(property in object)isFunction&&"prototype"==property||isProperty.call(members,property)||!(members[property]=1)||!isProperty.call(object,property)||callback(property)}:function(object,callback){var property,isConstructor,isFunction=getClass.call(object)==functionClass;for(property in object)isFunction&&"prototype"==property||!isProperty.call(object,property)||(isConstructor="constructor"===property)||callback(property);(isConstructor||isProperty.call(object,property="constructor"))&&callback(property)}:(members=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],forEach=function(object,callback){var property,length,isFunction=getClass.call(object)==functionClass,hasProperty=!isFunction&&"function"!=typeof object.constructor&&isHostType(object,"hasOwnProperty")?object.hasOwnProperty:isProperty;for(property in object)isFunction&&"prototype"==property||!hasProperty.call(object,property)||callback(property);for(length=members.length;property=members[--length];hasProperty.call(object,property)&&callback(property));}),forEach(object,callback)},!has("json-stringify")){var Escapes={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},leadingZeroes="000000",toPaddedString=function(width,value){return(leadingZeroes+(value||0)).slice(-width)},unicodePrefix="\\u00",quote=function(value){var symbols,result='"',index=0,length=value.length,isLarge=length>10&&charIndexBuggy;for(isLarge&&(symbols=value.split(""));length>index;index++){var charCode=value.charCodeAt(index);switch(charCode){case 8:case 9:case 10:case 12:case 13:case 34:case 92:result+=Escapes[charCode];break;default:if(32>charCode){result+=unicodePrefix+toPaddedString(2,charCode.toString(16));break}result+=isLarge?symbols[index]:charIndexBuggy?value.charAt(index):value[index]}}return result+'"'},serialize=function(property,object,callback,properties,whitespace,indentation,stack){var className,year,month,date,time,hours,minutes,seconds,milliseconds,results,element,index,length,prefix,hasMembers,result,value=object[property];try{value=object[property]}catch(exception){}if("object"==typeof value&&value)if(className=getClass.call(value),className!=dateClass||isProperty.call(value,"toJSON"))"function"==typeof value.toJSON&&(className!=numberClass&&className!=stringClass&&className!=arrayClass||isProperty.call(value,"toJSON"))&&(value=value.toJSON(property));else if(value>-1/0&&1/0>value){if(getDay){for(date=floor(value/864e5),year=floor(date/365.2425)+1970-1;getDay(year+1,0)<=date;year++);for(month=floor((date-getDay(year,0))/30.42);getDay(year,month+1)<=date;month++);date=1+date-getDay(year,month),time=(value%864e5+864e5)%864e5,hours=floor(time/36e5)%24,minutes=floor(time/6e4)%60,seconds=floor(time/1e3)%60,milliseconds=time%1e3}else year=value.getUTCFullYear(),month=value.getUTCMonth(),date=value.getUTCDate(),hours=value.getUTCHours(),minutes=value.getUTCMinutes(),seconds=value.getUTCSeconds(),milliseconds=value.getUTCMilliseconds();value=(0>=year||year>=1e4?(0>year?"-":"+")+toPaddedString(6,0>year?-year:year):toPaddedString(4,year))+"-"+toPaddedString(2,month+1)+"-"+toPaddedString(2,date)+"T"+toPaddedString(2,hours)+":"+toPaddedString(2,minutes)+":"+toPaddedString(2,seconds)+"."+toPaddedString(3,milliseconds)+"Z"}else value=null;if(callback&&(value=callback.call(object,property,value)),null===value)return"null";if(className=getClass.call(value),className==booleanClass)return""+value;if(className==numberClass)return value>-1/0&&1/0>value?""+value:"null";if(className==stringClass)return quote(""+value);if("object"==typeof value){for(length=stack.length;length--;)if(stack[length]===value)throw TypeError();if(stack.push(value),results=[],prefix=indentation,indentation+=whitespace,className==arrayClass){for(index=0,length=value.length;length>index;hasMembers||(hasMembers=!0),index++)element=serialize(index,value,callback,properties,whitespace,indentation,stack),results.push(element===undef?"null":element);result=hasMembers?whitespace?"[\n"+indentation+results.join(",\n"+indentation)+"\n"+prefix+"]":"["+results.join(",")+"]":"[]"}else forEach(properties||value,function(property){var element=serialize(property,value,callback,properties,whitespace,indentation,stack);element!==undef&&results.push(quote(property)+":"+(whitespace?" ":"")+element),hasMembers||(hasMembers=!0)}),result=hasMembers?whitespace?"{\n"+indentation+results.join(",\n"+indentation)+"\n"+prefix+"}":"{"+results.join(",")+"}":"{}";return stack.pop(),result}};JSON3.stringify=function(source,filter,width){var whitespace,callback,properties;if("function"==typeof filter||"object"==typeof filter&&filter)if(getClass.call(filter)==functionClass)callback=filter;else if(getClass.call(filter)==arrayClass){properties={};for(var value,index=0,length=filter.length;length>index;value=filter[index++],(getClass.call(value)==stringClass||getClass.call(value)==numberClass)&&(properties[value]=1));}if(width)if(getClass.call(width)==numberClass){if((width-=width%1)>0)for(whitespace="",width>10&&(width=10);whitespace.length<width;whitespace+=" ");}else getClass.call(width)==stringClass&&(whitespace=width.length<=10?width:width.slice(0,10));return serialize("",(value={},value[""]=source,value),callback,properties,whitespace,"",[])}}if(!has("json-parse")){var Index,Source,fromCharCode=String.fromCharCode,Unescapes={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},abort=function(){throw Index=Source=null,SyntaxError()},lex=function(){for(var value,begin,position,isSigned,charCode,source=Source,length=source.length;length>Index;)switch(charCode=source.charCodeAt(Index)){case 9:case 10:case 13:case 32:Index++;break;case 123:case 125:case 91:case 93:case 58:case 44:return value=charIndexBuggy?source.charAt(Index):source[Index],Index++,value;case 34:for(value="@",Index++;length>Index;)if(charCode=source.charCodeAt(Index),32>charCode)abort();else if(92==charCode)switch(charCode=source.charCodeAt(++Index)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:value+=Unescapes[charCode],Index++;break;case 117:for(begin=++Index,position=Index+4;position>Index;Index++)charCode=source.charCodeAt(Index),charCode>=48&&57>=charCode||charCode>=97&&102>=charCode||charCode>=65&&70>=charCode||abort();value+=fromCharCode("0x"+source.slice(begin,Index));break;default:abort()}else{if(34==charCode)break;for(charCode=source.charCodeAt(Index),begin=Index;charCode>=32&&92!=charCode&&34!=charCode;)charCode=source.charCodeAt(++Index);value+=source.slice(begin,Index)}if(34==source.charCodeAt(Index))return Index++,value;abort();default:if(begin=Index,45==charCode&&(isSigned=!0,charCode=source.charCodeAt(++Index)),charCode>=48&&57>=charCode){for(48==charCode&&(charCode=source.charCodeAt(Index+1),charCode>=48&&57>=charCode)&&abort(),isSigned=!1;length>Index&&(charCode=source.charCodeAt(Index),charCode>=48&&57>=charCode);Index++);if(46==source.charCodeAt(Index)){for(position=++Index;length>position&&(charCode=source.charCodeAt(position),charCode>=48&&57>=charCode);position++);position==Index&&abort(),Index=position}if(charCode=source.charCodeAt(Index),101==charCode||69==charCode){for(charCode=source.charCodeAt(++Index),43!=charCode&&45!=charCode||Index++,position=Index;length>position&&(charCode=source.charCodeAt(position),charCode>=48&&57>=charCode);position++);position==Index&&abort(),Index=position}return+source.slice(begin,Index)}if(isSigned&&abort(),"true"==source.slice(Index,Index+4))return Index+=4,!0;if("false"==source.slice(Index,Index+5))return Index+=5,!1;if("null"==source.slice(Index,Index+4))return Index+=4,null;abort()}return"$"},get=function(value){var results,hasMembers;if("$"==value&&abort(),"string"==typeof value){if("@"==(charIndexBuggy?value.charAt(0):value[0]))return value.slice(1);if("["==value){for(results=[];value=lex(),"]"!=value;hasMembers||(hasMembers=!0))hasMembers&&(","==value?(value=lex(),"]"==value&&abort()):abort()),","==value&&abort(),results.push(get(value));return results}if("{"==value){for(results={};value=lex(),"}"!=value;hasMembers||(hasMembers=!0))hasMembers&&(","==value?(value=lex(),"}"==value&&abort()):abort()),","!=value&&"string"==typeof value&&"@"==(charIndexBuggy?value.charAt(0):value[0])&&":"==lex()||abort(),results[value.slice(1)]=get(lex());return results}abort()}return value},update=function(source,property,callback){var element=walk(source,property,callback);element===undef?delete source[property]:source[property]=element},walk=function(source,property,callback){var length,value=source[property];if("object"==typeof value&&value)if(getClass.call(value)==arrayClass)for(length=value.length;length--;)update(value,length,callback);else forEach(value,function(property){update(value,property,callback)});return callback.call(source,property,value)};JSON3.parse=function(source,callback){var result,value;return Index=0,Source=""+source,result=get(lex()),"$"!=lex()&&abort(),Index=Source=null,callback&&getClass.call(callback)==functionClass?walk((value={},value[""]=result,value),"",callback):result}}}isLoader&&define(function(){return JSON3})}(window);var include=function(url,success,error){"use strict";if("string"!=typeof url)throw new Error("Invalid url for Javascript include.");if(void 0!==error&&"function"!=typeof success)throw new Error('Invalid success handler (second parameter) for Javascript include "'+url+'". It must be a function.');if(void 0!==error&&"function"!=typeof error)throw new Error('Invalid error handler (second parameter) for Javascript include "'+url+'". It must be a function.');var head=document.getElementsByTagName("head")[0],tag=document.createElement("script");tag.type="text/javascript",tag.async=!0,tag.charset="utf-8",
tag.onload=tag.onreadystatechange=function(){if(!this.readyState||"loaded"==this.readyState||"complete"==this.readyState){var details={src:this.src};this.onload=this.onreadystatechange=null;try{success.call(details,details)}catch(exception){exception.message="[Exceptions caught triggering error hadnler for request "+details.src+" » "+exception.message,error.call(details,details)}}},error&&tag.addEventListener&&tag.addEventListener("error",function(event){var details={src:url,evt:event};error.call(details,details)},!0),tag.src=url,head.appendChild(tag)};return{includeJS:include,DOMReady:function(ready){function flush(f){for(loaded=1;f=fns.shift();)f()}var fn,fns=[],f=!1,doc=document,testEl=doc.documentElement,hack=testEl.doScroll,domContentLoaded="DOMContentLoaded",addEventListener="addEventListener",onreadystatechange="onreadystatechange",readyState="readyState",loadedRgx=hack?/^loaded|^c/:/^loaded|c/,loaded=loadedRgx.test(doc[readyState]);return doc[addEventListener]&&doc[addEventListener](domContentLoaded,fn=function(){doc.removeEventListener(domContentLoaded,fn,f),flush()},f),hack&&doc.attachEvent(onreadystatechange,fn=function(){/^c/.test(doc[readyState])&&(doc.detachEvent(onreadystatechange,fn),flush())}),ready=hack?function(fn){self!=top?loaded?fn():fns.push(fn):function(){try{testEl.doScroll("left")}catch(e){return setTimeout(function(){ready(fn)},50)}fn()}()}:function(fn){loaded?fn():fns.push(fn)}}(),renderDebugChart:function(data){setTimeout(function(){YUI().use("charts",function(Y){var myDataValues=[{ADS:"DFP Success",value:data.dfp_success},{ADS:"DFP Errors",value:data.dfp_errors},{ADS:"PPI Success",value:data.ppi_success},{ADS:"PPI Errors",value:data.ppi_errors}];new Y.Chart({render:"#adsmetachart",categoryKey:"ADS",seriesKeys:["value"],dataProvider:myDataValues,type:"pie",legend:{position:"left",width:100,height:100,styles:{hAlign:"center",hSpacing:4}},seriesCollection:[{categoryKey:"ADS",valueKey:"value"}]})})},1e3)},initYUIConsole:function(){include("http://yui.yahooapis.com/3.14.1/build/yui/yui-min.js",function(){document.body.setAttribute("class","yui3-skin-sam"),YUI().use("console-filters","dd-plugin",function(Y){var yconsole=new Y.Console({newestOnTop:!0,style:"separate"});yconsole.plug(Y.Plugin.ConsoleFilters,{defaultVisibility:!0}),yconsole.plug(Y.Plugin.Drag,{handles:[".yui3-console-hd"]}),yconsole.render(),Y.log("YUI Log Console started","info","zaz-admanager"),AdManager.setLogHandler(function(){var msg=this.message,category="info";msg.match(/\[ERROR\]/)&&(category="error"),msg.match(/\[WARN\]/)&&(category="warn"),msg.match(/\[INFO\]/)&&(category="info"),msg.match(/\[DEBUG\]/)&&(category="debug"),Y.log(this.message,category,"zaz-admanager")}),document.querySelectorAll(".yui3-widget")[0].style.position="fixed",document.querySelector(".yui3-widget").style.zIndex="99999999999",AdManager.set("YUI_CONSOLE",yconsole)})})},extend:function(){if(arguments.length<=1)throw new Error('The "extend" function must receive at least two objects as parameters.');for(var targetObject,current,attributeId,objects=Array.prototype.slice.call(arguments),returnedObjectType=objects[0]instanceof Array?"array":"object",compiledObject="array"===returnedObjectType?[]:{};objects.length;){if(current=objects.shift(),"object"!=typeof current||"array"===returnedObjectType&&!(current instanceof Array)||"object"===returnedObjectType&&current instanceof Array)throw new Error('You can\'t combine different types of objects together. They must be all "objects" or "arrays".');for(attributeId in current)current.hasOwnProperty(attributeId)&&void 0!==current[attributeId]&&("object"==typeof current[attributeId]&&null!==current[attributeId]?compiledObject[attributeId]=this.extend(current[attributeId]instanceof Array?[]:{},current[attributeId]):compiledObject[attributeId]=current[attributeId]);targetObject||objects.length||(objects.push(compiledObject),targetObject=compiledObject=arguments[0])}return targetObject}}}()},{}],7:[function(require,module,exports){module.exports="1.3.11"},{}],8:[function(require,module,exports){!function(){"use strict";if(window.AdManager)throw new Error("AdManager already loaded");require("./lib/promise/promise");var PUBLIC_STATIC,AdManager,STATIC={libs:{},instances:[],mock:!1,log:null,pageAds:{},ADS:[],ads:{},viewportAds:{},filters:[],queue:[],setupPromises:{},setupReady:!1,setupOnce:!1,attributes:{},setupPromise:null,stickAdRunning:!1,viewableAds:[],tgmKeyHasChanged:0,adsmeta:{dfp_ads:0,dfp_success:0,dfp_errors:0,ppi_ads:0,ppi_success:0,ppi_errors:0,generic_ads:0,generic_success:0,generic_errors:0,onupdate:function(fn){"function"==typeof fn&&fn.apply()}}},protocol=document.location.protocol||"http:",PRIVATE={initOnce:!1,isDeubugging:!1,ready:!1,curEnv:"prd",curViewport:1,env:{prd:{htmlPath:"/globalSTATIC/fe/zaz-mod-manager/",htmlFile:"zaz-frame.html",tagmanURL:protocol+"//p2.trrsf.com/tagmanfe/ShowArea.aspx"},dsv:{htmlPath:"../dist/",htmlFile:"zaz-frame.html",tagmanURL:protocol+"//p2.trrsf.com/tagmanfe/ShowArea.aspx"},tmp:{htmlPath:"/globalSTATIC/fe/zaz-mod-manager/",htmlFile:"zaz-admanager-tmp.html",tagmanURL:protocol+"//tagmanfe-hlg.tpn.terra.com/ShowArea.aspx"}},settings:{VIEWPORT_MAX:4,VIEWPORT_ORDER:[2,3,4],TGMKEY:null,PPI_URL:"http://ppi.terra.com.br/showArea.asp",RUBICON_ACCOUNT_ID:"10828",RUBICON_DFP_NETWORK_ID:"1211",RUBICON_TIMEOUT:3e3,PLATFORM:"web",THIRDPARTY_TIMEOUT:3e3,tagmanDefaultArea:"setup",TAGMAN_TIMEOUT:2e3,PPI_TIMEOUT:2e3,DFP_TIMEOUT:800,DFP_IFRAME_INTERVAL_CHECKER:501,DEFAULT_GOOGLE_TAG:null,NO_ADS:!1,ADS_METRICS_PUSH:10,ADS_METRICS_PERCENTAGE:10,EXP_DISCARD_SETUP_FOR_TGMKEY:/\.(selo)/i},lockTgmKeyChange:!1,Log:require("./lib/log/log"),Util:require("./lib/util/util"),FiF:require("./lib/fif/fif"),uid:function(){return Math.random().toString(32).slice(2)},clone:function(obj){if(null===obj||"object"!=typeof obj)return obj;var copy=obj.constructor();for(var attr in obj)obj.hasOwnProperty(attr)&&(copy[attr]=obj[attr]);return copy},getTgmKey:function(){var match=window.location.search.match("[?&]tgmkey=([^&]+)"),tgmkey=null;return match?(PRIVATE.lockTgmKeyChange=!0,tgmkey=match[1]):window.tgmKey&&(tgmkey=window.tgmKey),tgmkey},startEvents:function(){STATIC.log||(STATIC.log=new PRIVATE.Log("zaz-admanager"));try{window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[]}catch(e){STATIC.log.write('[WARN] Exception pre-defining "googletag" as a global object: '+e.message)}/tpn=1/.test(location.search)&&location.search.replace(/[\?&]mod\.adManager\.(.+?)=([^&]+)/g,function(match,key,value){if(STATIC.log.write('[INFO] special queryString param detected: "'+key+"="+value+'"'),/^\d+$/.test(value))value=parseInt(value,10);else if(/^true|false$/.test(value))value="true"===value;else if(/\[.*?\]/.test(value)&&"object"==typeof window.JSON)try{value=JSON.parse(value)}catch(e){STATIC.log.write('[WARN] Error evaluating special queryString param "'+key+"="+value+'": '+e.message)}else try{value=decodeURIComponent(value)}catch(e){STATIC.log.write('[WARN] Error decoding special queryString param "'+key+"="+value+'": '+e.message)}PRIVATE.settings[key.toUpperCase()]=value}),PRIVATE.Util.DOMReady(function(){require("./lib/native-filters/native-filters"),(PRIVATE.settings.DEBUG||document.location.search.match(/zaz-debug/g))&&AdManager.debug(),(PRIVATE.settings.BYPASS||document.location.search.match(/zaz-admanager\[noads\]=true/g))&&(PRIVATE.settings.NO_ADS=!0)}),window.addEventListener("load",function(){var isCtrl=!1,isOpened=!1;document.onkeyup=function(e){17===e.which&&(isCtrl=!1)},document.onkeydown=function(e){return 17!==e.which&&224!==e.which||(isCtrl=!0),120===e.which&&isCtrl===!0?(isOpened?(AdManager.get("YUI_CONSOLE").hide(),isOpened=!1):(AdManager.debug(),isOpened=!0),!1):void 0}})},isTGMKEYSetupable:function(tgmKey){var setupable=/(.+?[\.]){2,}/.test(tgmKey);return PRIVATE.settings.EXP_DISCARD_SETUP_FOR_TGMKEY instanceof RegExp&&PRIVATE.settings.EXP_DISCARD_SETUP_FOR_TGMKEY.test(tgmKey)&&(setupable=!1),/\.live/.test(tgmKey)&&tgmKey!==PRIVATE.settings.TGMKEY&&(setupable=!1),setupable},waitForSetupDefinition:function(tgmKey){var timer,promise,done=!1,handlers={},isDocumentReady=!/in/.test(document.readyState);return promise=new Promise(function(resolve,reject){return console.log("[AdManager] waitForSetupDefinition for "+tgmKey),handlers.resolve=function(){done||(done=!0,timer&&(timer=clearInterval(timer)),STATIC.setupPromises[tgmKey]&&STATIC.setupPromises[tgmKey].resolve&&delete STATIC.setupPromises[tgmKey].resolve,STATIC.attributes["setup_done_for_"+tgmKey]||!PRIVATE.isTGMKEYSetupable(tgmKey)?(PRIVATE.isTGMKEYSetupable(tgmKey)?console.log("[AdManager] Setup resolved template declaration for tgmKey "+tgmKey):console.log("[AdManager] setup for "+tgmKey+" discarted by config"),resolve()):PRIVATE.requestSetupForTGMKEY(tgmKey).then(resolve,reject))},handlers.reject=function(){done=!0,timer&&(timer=clearInterval(timer)),STATIC.setupPromises[tgmKey].reject&&delete STATIC.setupPromises[tgmKey].reject,console.warn("[AdManager] setup for "+tgmKey+" rejected")},isDocumentReady||STATIC.attributes["setup_done_for_"+tgmKey]||!PRIVATE.isTGMKEYSetupable(tgmKey)?void handlers.resolve():(document.addEventListener?document.addEventListener("DOMContentLoaded",handlers.resolve,!1):document.attachEvent&&document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&setTimeout(handlers.resolve,1)}),void(timer=setInterval(function(){/in/.test(document.readyState)||(timer&&(timer=clearInterval(timer)),done||handlers.resolve())},300)))}),promise.resolve=handlers.resolve,promise},requestSetupForTGMKEY:function(tgmKey){return tgmKey=tgmKey||PRIVATE.settings.TGMKEY,new Promise(function(resolve,reject){var url=PRIVATE.env[PUBLIC_STATIC.getEnv()].tagmanURL+"?key="+tgmKey+"."+PRIVATE.settings.tagmanDefaultArea+"&direct=1";console.log("[AdManager] Loading setup area for tgmKey "+tgmKey+"\n@ "+url),PRIVATE.Util.includeJS(url,function(){STATIC.log.write("[INFO] Successfully load setup tagman area."),STATIC.setupOnce=!0,STATIC.setupReady=!0,console.log("[AdManager] Setup resolved by external url for tgmKey "+tgmKey),resolve()},function(){var msg="[AdManager] Error loading setup area for tgmKey "+tgmKey+"\n@ "+url+"\nWe will try to load ups ads anymway...";STATIC.log.write("[ERROR] "+msg),resolve(msg),PUBLIC_STATIC.onError.call(this,msg)})})},setup:function(settings){if("[object Object]"!=Object.prototype.toString.call(settings))return Promise.reject(new Error("Invalid settings to run setup: "+settings));var promise,tgmKey=settings.tgmkey||PRIVATE.settings.TGMKEY,isDocumentReady=!/in/.test(document.readyState);if(STATIC.setupPromises[tgmKey]){if((STATIC.attributes["setup_done_for_"+tgmKey]||!PRIVATE.isTGMKEYSetupable(tgmKey))&&"function"==typeof STATIC.setupPromises[tgmKey].resolve)try{STATIC.setupPromises[tgmKey].resolve()}catch(e){console.error("[AdManager] Error aborting dynamic setup of tgmkey "+tgmKey+": "+e.message,e)}}else if(console.log("[AdManager] First setup call for tgmKey "+tgmKey),STATIC.attributes["setup_done_for_"+tgmKey]||!PRIVATE.isTGMKEYSetupable(tgmKey))PRIVATE.isTGMKEYSetupable(tgmKey)?console.log("[AdManager] setup preloaded on template for "+tgmKey):console.log("[AdManager] setup for "+tgmKey+" discarted by config"),STATIC.setupPromises[tgmKey]=Promise.resolve(!0);else{"function"!=typeof settings.onBeforeStart&&(settings.onBeforeStart=isDocumentReady?PRIVATE.requestSetupForTGMKEY:PRIVATE.waitForSetupDefinition);try{STATIC.setupPromises[tgmKey]=settings.onBeforeStart(tgmKey)}catch(setupException){console.error("[AdManager] Error running setup of tgmkey "+tgmKey+": "+setupException.message,setupException),STATIC.setupPromises[tgmKey]=setupException}}return promise=new Promise(function(resolve,reject){STATIC.setupPromises[tgmKey]instanceof Promise?STATIC.setupPromises[tgmKey].then(resolve,reject):resolve(STATIC.setupPromises[tgmKey])})},initialize:function(){STATIC.log||(STATIC.log=new PRIVATE.Log("zaz-admanager")),STATIC.log.write("[INFO] Initializing AdManager"),PRIVATE.metrics.init()},initDFP:function(){STATIC.log.write("[INFO] initDFP called"),window.googletag&&"object"==typeof window.googletag||(window.googletag={}),window.googletag.cmd&&"object"==typeof window.googletag.cmd||(window.googletag.cmd=[]),window.googletag.cmd.push(function(){var pageConfig={allowPushExpansion:!0,sandbox:!0};window.googletag.pubads().setSafeFrameConfig(pageConfig),window.googletag.pubads().disableInitialLoad(),window.googletag.pubads().enableSingleRequest(),window.googletag.pubads().enableAsyncRendering(),window.googletag.enableServices()}),window.zaz&&zaz.use(function(pkg){pkg.includer.load(["mod.gpt"]).then(function(googletag){STATIC.log.write("[INFO] Google GPT loaded successfully")})})},renderQueuedAds:function(){for(var queue=STATIC.queue,len=queue.length,i=0;len>i;i+=1)queue[i].call(this)},render:function(conf,cb){switch(PRIVATE.checkReloadRules(conf,[conf]),conf.adserver){case"prebid":PRIVATE.renderPrebid(conf,cb);break;case"rubicon":PRIVATE.renderRubicon(conf,cb);break;case"dfp":PRIVATE.renderDFP(conf,cb);break;case"ppi":PRIVATE.renderPPI(conf,cb);break;case"uri":PRIVATE.renderGeneric(conf,cb);break;default:STATIC.log.write("[ERROR] Invalid adserver definition for ad "+conf.placeholder+".")}},reloadHandlers:{always:function(current){var timer,reloads=0,conf=current;timer=setInterval(function(){STATIC.log.write("[INFO] Reload triggered for ad "+conf.placeholder+".");var elem=document.getElementById(conf.placeholder);try{if(!elem)throw new Error("[WARN] Container of "+conf.placeholder+" not found. Disabling automatic reload.");PUBLIC_STATIC.reload(conf.placeholder).then(function(data){reloads++,STATIC.log.write("[INFO] Reloded ad "+conf.placeholder),conf.reloadRule.times!==1/0&&reloads>=conf.reloadRule.times&&timer&&(timer=clearInterval(timer),STATIC.log.write("[INFO] Ad "+conf.placeholder+" reached its reload limit: "+conf.reloadRule.times+" times."))},function(e){timer&&(timer=clearInterval(timer)),e instanceof Error||(e=new Error("Unknown error >> "+e)),STATIC.log.write("[ERROR] Exception reloading ad "+conf.placeholder+": "+e.message)})}catch(e){timer&&(timer=clearInterval(timer)),STATIC.log.write("[ERROR] Exception reloading ad "+conf.placeholder+": "+e.message)}},conf.reloadRule.loop)},viewable:function(conf,wholeList){window.zaz&&zaz.use(function(pkg){pkg.require(["mod.viewable"],function(Viewable){if(!STATIC.viewable){var viewable=new Viewable;STATIC.viewable=viewable}})});var times=1,interval=null,timestamp=new Date,match=(document.getElementById(conf.placeholder),window.location.search.match("[?&]reload_interval=([^&]+)")),reloadIntervalByURL=match?match[1]:!1,supportsPageVisibility=function(){return void 0!==typeof document.visibilityState&&void 0!==typeof document.visibilityState},isPageVisible=function(){return!(!supportsPageVisibility()||"visible"!==document.visibilityState)},intervalReload=function(conf){interval&&clearInterval(interval),timestamp=new Date,conf.reloadRule&&conf.reloadRule.reload===!0&&(STATIC.log.write("[INFO] Enabling viewable reload for ad "+conf.placeholder),interval=setInterval(function(){document.getElementById(conf.placeholder)&&times<=conf.reloadRule.times?STATIC.viewable&&reload(conf):(clearInterval(interval),STATIC.log.write("[INFO] Stopping to listen ad viewable "+conf.placeholder))},reloadIntervalByURL?reloadIntervalByURL:conf.reloadRule.loop))},reload=function(conf,force){var viewable=STATIC.viewable,elem=document.getElementById(conf.placeholder);return timestamp=new Date,elem?void(force||isPageVisible()&&viewable.isVisible(elem,.5)?(PUBLIC_STATIC.reload(conf.placeholder).then(function(data){STATIC.log.write("[INFO] Reloading ad "+conf.placeholder)},function(e){}),times+=1):STATIC.log.write("[WARN] Ad "+conf.placeholder+" is not viewable or the page is hidden")):void STATIC.log.write("[WARN] placeholder for "+conf.placeholder+" NOT FOUND. Bypassing reload call.")},checkViewability=function(conf){var container=document.getElementById(conf.placeholder);STATIC.viewable.onVisibilityChange(document.getElementById(conf.placeholder),.5,function(){var now=new Date;STATIC.log.write("[INFO]"+conf.placeholder+" is visible"),interval&&(interval=clearInterval(interval)),conf.viewedOnce?conf.reloadRule.reload===!0&&times<=conf.reloadRule.times&&now-timestamp>=(reloadIntervalByURL?reloadIntervalByURL:conf.reloadRule.loop)&&reload(conf,!0):timestamp=new Date,conf.viewedOnce=!0,intervalReload(conf)},function(){STATIC.log.write("[INFO]"+conf.placeholder+" is hidden")}),!conf.viewedOnce&&STATIC.viewable.isVisible(container)&&(conf.viewedOnce=!0,intervalReload(conf))};STATIC.log.write("[INFO] Starting to listen viewable ad "+conf.placeholder+" for reloading feature"),window.zaz&&zaz.use(function(pkg){pkg.require(["mod.viewable"],function(Viewable){var placeholder,viewable=new Viewable(50);STATIC.viewable=viewable;try{if(placeholder=conf.placeholder&&"string"==typeof conf.placeholder?document.getElementById(conf.placeholder):null,conf.reloadRule){if(!placeholder)return void STATIC.log.write("[WARN] There's no valid placeholder to apply viewable reloadRule: #"+conf.placeholder+" (element ofr this selector is "+Object.prototype.toString.call(placeholder)+")");if("string"==typeof conf.reloadRule&&(conf.reloadRule=JSON.parse(conf.reloadRule)),!conf.reloadRule||"object"!=typeof conf.reloadRule)throw new Error("Invalid value passed to reloadRule: "+conf.reloadRule);conf.reloadRule.reload===!0&&checkViewability(conf)}}catch(viewabilityException){STATIC.log.write("[ERROR] Applying viewabilty rules for "+conf.placeholder+": "+viewabilityException.message)}})})}},checkReloadRules:function(conf,wholeList){if(!conf.reloadRulesApplyed){conf.reloadRulesApplyed=!0,STATIC.log.write("[INFO] Evaluating reload rules for "+conf.placeholder+".");var reloadRule;if("object"!=typeof conf||"object"!=typeof conf.reloadRule)return void STATIC.log.write("[WARN] There are no reload rules defined for ad "+conf.placeholder+". This one WILL NOT BE RELADED.");if(reloadRule=conf.reloadRule,reloadRule.reload){if(!reloadRule.type||"string"!=typeof reloadRule.type||"object"!=typeof PRIVATE.reloadHandlers||"function"!=typeof PRIVATE.reloadHandlers[reloadRule.type])return void STATIC.log.write('[WARN] Reload "type" invalid or not implemented for ad '+conf.placeholder+': "'+reloadRule.type+'". This one WILL NOT BE RELADED.');if(reloadRule.loop=parseInt(reloadRule.loop,10),isNaN(reloadRule.loop)||reloadRule.loop<35e3)return STATIC.log.write('[WARN] Invalid "loop" reload rule for ad '+conf.placeholder+": "+reloadRule.loop+". This one WILL NOT BE RELADED."),void(reloadRule.reload=!1);if(void 0===reloadRule.times&&(reloadRule.times=1/0),reloadRule.times!==1/0&&(reloadRule.times=parseInt(reloadRule.times,10)),reloadRule.times!==1/0&&("number"!=typeof reloadRule.times||isNaN(reloadRule.times)||reloadRule.times<=0))return STATIC.log.write('[WARN] Invalid "times" reload rule for ad '+conf.placeholder+": "+reloadRule.times+". This one WILL NOT BE RELADED."),void(reloadRule.reload=!1);try{STATIC.log.write("[INFO] Applying reload rules for "+conf.placeholder+"."),PRIVATE.reloadHandlers[reloadRule.type](conf,wholeList)}catch(e){STATIC.log.write('[Error] Exception triggering reload handler "'+reloadRule.type+'" for ad '+conf.placeholder+': "'+e.message+'". This one MAY NOT BE RELADED.')}}}},getGPT:function(){return STATIC.libs.gpt?STATIC.libs.gpt:(STATIC.log.write("[INFO] loading GPT API"),window.googletag&&"object"==typeof window.googletag||(window.googletag={}),window.googletag.cmd&&"object"==typeof window.googletag.cmd||(window.googletag.cmd=[]),STATIC.libs.gpt=new Promise(function(resolveGPT,rejectGPT){window.googletag.cmd.push(function(){try{var pageConfig={allowPushExpansion:!0,sandbox:!0};window.googletag.pubads().setSafeFrameConfig(pageConfig),window.googletag.pubads().disableInitialLoad(),window.googletag.pubads().enableSingleRequest(),window.googletag.pubads().enableAsyncRendering(),window.googletag.enableServices(),window.googletag.pubads().addEventListener("slotRenderEnded",function(event){var current,width,height,placeholderElem,containerId=event.slot.getSlotElementId(),conf=STATIC.pageAds[containerId];if(conf){if(window.zaz.use(function(pkg){pkg.context.page.trigger("ad-slotrenderended",{sender:"zaz-admanager",id:containerId,slot:conf})}),conf.exibitions=conf.exibitions||0,conf.exibitions++,conf.marks||(conf.marks={}),conf.marks.requestedByUI||(conf.marks.requestedByUI=new Date),conf.marks.rendered=new Date,!conf.reloadSize)try{if(event.size&&"object"==typeof event.size&&2==event.size.length)width=event.size[0],height=event.size[1];else{if(placeholderElem=document.getElementById(conf.placeholder))try{conf.iframeElem=placeholderElem.getElementsByTagName("div")[0].getElementsByTagName("iframe")[0],STATIC.log.write("[INFO] Google Iframe for ["+conf.placeholder+"] found.")}catch(error){STATIC.log.write("[ERROR] Cannot find Google Iframe for placeholder "+conf.placeholder)}conf.iframeElem&&(width=conf.iframeElem.getAttribute("width"),height=conf.iframeElem.getAttribute("height"))}width=parseInt(width,10),height=parseInt(height,10),!width||!height||isNaN(width)||isNaN(height)?console.warn("[AdManager] Unknown dimensions for ["+conf.placeholder+"]. The corresponding iframe must declare a fixed width and height"):(console.log("[AdManager] AdSlot for placeholder "+conf.placeholder+" rendered as "+width+"x"+height),width>1&&height>1?conf.reloadSize=[width,height]:console.log("[AdManager] This adSlot is not reloadable: "+conf.placeholder))}catch(reloadSizeException){STATIC.log.write("[AdManager] Exception discovering reload size for "+conf.placeholder)}if(conf.listeners&&"object"==typeof conf.listeners&&"[object Array]"==Object.prototype.toString.call(conf.listeners.load))for(;conf.listeners.load.length;){current=conf.listeners.load.shift();try{event&&event.isEmpty?(console.warn("[AdManager] AdSlot for "+conf.placeholder+" delivered by DFP is empty. This is not not exectly an error. Maybe some campaign is about to start up. If your not sure, ask AdOps about it!"),current.call(conf,{width:0,height:0,error:!1,time:conf.marks.rendered.getTime()-conf.marks.requestedByUI.getTime()+"ms",conf:conf})):current.call(conf,{width:conf.reloadSize[0],height:conf.reloadSize[1],error:!1,time:conf.marks.rendered.getTime()-conf.marks.requestedByUI.getTime()+"ms",conf:conf})}catch(callbackException){STATIC.log.write("Error triggering load callback for "+conf.placeholder+": "+callbackException.message)}}}}),STATIC.log.write("[INFO] GPT initialized")}catch(exception){STATIC.log.write("[WARN] Exception definning global setting for GPT: "+exception.message)}finally{resolveGPT(window.googletag)}}),window.zaz.use(function(pkg){STATIC.log.write("[INFO] requirering GPT API"),pkg.require(["mod.gpt"]).then(function(dependencies){var exception,googletag=dependencies.mod.gpt;return googletag&&"object"==typeof googletag&&"object"==typeof googletag.cmd&&"function"==typeof googletag.cmd.push?void STATIC.log.write("[INFO] mod.GPT successfully loaded by Includer"):(exception=new Error("GPT API not available"),STATIC.log.write("[ERROR] "+exception.message),rejectGPT(exception),exception)},function(e){return exception=new Error("Problem requesting GPT API: "+e.message),STATIC.log.write("[ERROR] "+exception.message),rejectGPT(exception),exception})})}),STATIC.libs.gpt)},getRubicon:function(){return STATIC.libs.rubicon?STATIC.libs.rubicon:(window.rubicontag&&"object"==typeof window.rubicontag||(window.rubicontag={}),window.rubicontag.cmd&&"object"==typeof window.rubicontag.cmd||(window.rubicontag.cmd=[]),STATIC.libs.rubicon=new Promise(function(resolveRubicon,rejectRubicon){STATIC.log.write("[INFO] Openning zaz frameworkt to require dependencies."),window.zaz.use(function(pkg){STATIC.log.write("[INFO] Requiring Rubicon and GPT"),Promise.all([PRIVATE.getGPT(),pkg.require(["mod.rubicon"])]).then(function(deps){var rubicontag=(deps[0],deps[1]);return rubicontag&&"object"==typeof rubicontag&&"object"==typeof rubicontag.mod&&"object"==typeof rubicontag.mod.rubicon&&"object"==typeof rubicontag.mod.rubicon.cmd&&"function"==typeof rubicontag.mod.rubicon.cmd.push&&"function"==typeof rubicontag.mod.rubicon.run?(window.rubicontag.cmd.push(function(){console.log("[AdManager] rubicon.cmd() called. Realising corresponding ads."),STATIC.log.write("[INFO] RP rubicontag initialized"),resolveRubicon(window.rubicontag)}),void(rubicontag=rubicontag.mod.rubicon)):void rejectRubicon(new Error("Error loading Rubicon API: invalid object window.rubicontag."))},function(e){STATIC.log.write("[ERROR] Error requireing RUbicon dependencies: "+e.message),rejectRubicon(exception)})})}),STATIC.libs.rubicon)},getPrebid:function(){return STATIC.libs.prebid?STATIC.libs.prebid:(STATIC.libs.prebid=new Promise(function(resolvePrebid,rejectPrebid){STATIC.log.write("[INFO] Openning zaz frameworkt to require dependencies."),window.zaz.use(function(pkg){STATIC.log.write("[INFO] Requiring Prebid and GPT"),Promise.all([PRIVATE.getGPT(),pkg.require(["mod.prebid"])]).then(function(deps){var pbjs=(deps[0],deps[1]);if(!pbjs||"object"!=typeof pbjs.mod||"object"!=typeof pbjs.mod.prebid||"object"!=typeof pbjs.mod.prebid.que)return void rejectPrebid(new Error("Error loading Prebid API: invalid object window.rubicontag."));var callEvent=!1,queryStrings=pkg.context.page.get("query");pkg.context.publisher.get("template");queryStrings&&"true"==queryStrings["ga-prebid"]&&(callEvent=!0),callEvent&&window.pbjs.que.push(function(){window.pbjs.enableAnalytics([{provider:"ga",options:{enableDistribution:!1}}])}),resolvePrebid(window.pbjs)},function(e){STATIC.log.write("[ERROR] Error requireing Prebid dependencies: "+e.message),rejectPrebid(exception)})})}),STATIC.libs.prebid)},renderDFP:function(conf,cb){var mapping,gtag=null,keywords=null,DOMElem=document.getElementById(conf.placeholder),wrapper=(new Date,null),adslot=null;if(conf.adslot||conf.reloaded){if(!conf.reloadSize)return void STATIC.log.write("[ERROR] Reload prevented because ad size could not be detected for "+conf.placeholder);try{mapping=googletag.sizeMapping().addSize([0,0],conf.reloadSize).build(),conf.adslot=conf.adslot.defineSizeMapping(mapping),conf.adslot.setTargeting("refresh",++conf.adslot.countRefresh),googletag.pubads().refresh([conf.adslot])}catch(e){STATIC.log.write("[ERROR] Exception reloading "+conf.placeholder+" (using GPT API): "+e.message),cb.call(null,{width:0,height:0,error:"[ERROR] Exception reloading "+conf.placeholder+" (using GPT API)",conf:conf})}finally{return}}return STATIC.libs.gpt||PRIVATE.getGPT(),DOMElem&&"object"==typeof DOMElem&&1===DOMElem.nodeType?(wrapper=document.getElementById(conf.placeholder+"--wrapper"),wrapper||(wrapper=document.createElement("div"),wrapper.style.display="none",wrapper.id=conf.placeholder+"--wrapper",DOMElem.style.minHeight=DOMElem.style.minHeight||"1px",DOMElem.parentNode.replaceChild(wrapper,DOMElem),wrapper.appendChild(DOMElem),wrapper.style.display="block"),conf.listeners||(conf.listeners={},"function"==typeof cb&&(conf.listeners.load||(conf.listeners.load=[]),conf.listeners.load.push(cb))),conf.marks||(conf.marks={}),conf.marks.requestedByUI=new Date,PUBLIC_STATIC.onNewAd.call(this,conf),STATIC.adsmeta.dfp_ads+=1,STATIC.adsmeta.onupdate(),STATIC.log.write("[INFO] renderDFP called ("+PRIVATE.settings.PLATFORM+")"),gtag=conf.google_tag&&"string"==typeof conf.google_tag?conf.google_tag:null,keywords=conf.keywords&&"object"==typeof conf.keywords?conf.keywords:null,null!==gtag&&STATIC.log.write("[INFO] Google Tag was found for ad "+conf.placeholder+" = "+gtag),void PRIVATE.getGPT().then(function(googletag){if(STATIC.log.write("[INFO] GPT stuff... Defining slot, enabling single Requesting and services"),adslot=googletag.defineSlot(gtag||PRIVATE.settings.DEFAULT_GOOGLE_TAG,conf.sizes,conf.placeholder),conf.adslot=adslot,adslot.addService(googletag.pubads()),mapping=googletag.sizeMapping().addSize([0,0],conf.sizes).build(),conf.adslot.defineSizeMapping(mapping),conf.viewport&&adslot.setTargeting("viewport","s"+conf.viewport),conf.adslot.countRefresh=0,conf.adslot.setTargeting("refresh","0"),conf.reloaded||(STATIC.pageAds[conf.placeholder]=conf),null!==keywords){STATIC.log.write("[INFO] Keywords was found for "+conf.placeholder+" = "+gtag);try{for(var i in keywords)STATIC.log.write("[INFO] Defining keyword "+i+" with value = "+keywords[i].toString()),adslot.setTargeting(i,keywords[i])}catch(error){STATIC.log.write("[ERROR] Something wrong defining keywords")}}googletag.display(conf.placeholder),googletag.pubads().refresh([conf.adslot]),setTimeout(function(){conf.exibitions||(STATIC.adsmeta.dfp_errors+=1,STATIC.log.write("[ERROR] TIMEOUT! Unable to find the Google Iframe, or the iframe size is [1x1] for placeholder ["+conf.placeholder+"] - Time: "+((new Date).getTime()-conf.marks.requestedByUI.getTime())+"ms"),"function"==typeof cd&&cb.call(this,{width:0,height:0,error:"Timeout DFP ad",conf:conf}))},PRIVATE.settings.DFP_TIMEOUT)}).then(null,function(e){STATIC.adsmeta.dfp_errors+=1,STATIC.log.write("[ERROR] Exception triggering "+conf.placeholder+": "+e.message),cb.call(obj,{width:0,height:0,error:"[ERROR] Exception triggering "+conf.placeholder,conf:conf})})):(STATIC.log.write("[ERROR] Invalid placeholder "+conf.placeholder),STATIC.ADS.length=0,void cb.call(obj,{width:0,height:0,error:"[ERROR] Invalid placeholder "+conf.placeholder,conf:conf}))},renderPrebid:function(conf,cb){var wrapper,key,adUnitDivId,mapping,PREBID_TIMEOUT=conf.timeout||2e3,DOMElem=(new Date,document.getElementById(conf.placeholder)),obj=this;if(adUnitDivId=conf.placeholder,conf.adslot||conf.reloaded){if(!conf.reloadSize)return void STATIC.log.write("[ERROR] Reload prevented because ad size could not be detected for "+conf.placeholder);try{mapping=googletag.sizeMapping().addSize([0,0],conf.reloadSize).build(),conf.adslot=conf.adslot.defineSizeMapping(mapping)}catch(mappingException){return STATIC.log.write("[ERROR] Exception remapping slot sizes of  "+conf.placeholder+" for reload (using GPT API): "+mappingException.message),void cb.call(null,conf)}conf.adslot.clearTargeting(),conf.viewport&&conf.adslot.setTargeting("viewport","s"+conf.viewport),conf.adslot.setTargeting("refresh",++conf.adslot.countRefresh);try{for(key in conf.keywords)STATIC.log.write("[INFO] Defining keyword "+key+" with value = "+conf.keywords[key].toString()),conf.adslot.setTargeting(key,conf.keywords[key])}catch(error){STATIC.log.write("[ERROR] Something wrong defining keywords")}var sendAdserverRequest=function(){googletag.cmd.push(function(){pbjs.que.push(function(){pbjs.setTargetingForGPTAsync([conf.placeholder]),googletag.pubads().refresh([conf.adslot])})})};window.pbjs.que.push(function(){window.pbjs.requestBids({labels:["admanager"],adUnitCodes:[conf.placeholder],bidsBackHandler:sendAdserverRequest,timeout:PREBID_TIMEOUT})})}return DOMElem&&"object"==typeof DOMElem&&1===DOMElem.nodeType?(wrapper=document.getElementById(conf.placeholder+"--wrapper"),wrapper||(wrapper=document.createElement("div"),wrapper.style.display="none",wrapper.id=conf.placeholder+"--wrapper",DOMElem.style.minHeight=DOMElem.style.minHeight||"1px",DOMElem.parentNode.replaceChild(wrapper,DOMElem),wrapper.appendChild(DOMElem),wrapper.style.display="block"),conf.listeners||(conf.listeners={},"function"==typeof cb&&(conf.listeners.load||(conf.listeners.load=[]),conf.listeners.load.push(cb))),conf.marks||(conf.marks={}),conf.marks.requestedByUI=new Date,void PRIVATE.getPrebid().then(function(rubicontag){function sendAdserverRequest(x){if(console.log("PREBID sendAdserverRequest:",x),/^header\-ad/.test(conf.placeholder)&&window.performance&&"function"==typeof window.performance.mark)try{window.performance.mark("AD_S0_BIDDING_END")}catch(perfException){window.console&&"object"==typeof window.console&&("function"==typeof window.console.warn?window.console.warn("[AdManager] Error registering performance metric AD_S0_BIDDING_END. "+perfException.message):"function"==typeof window.console.log&&window.console.error("[AdManager] Error registering performance metric AD_S0_BIDDING_END. "+perfException.message));
}googletag.cmd.push(function(){pbjs.que.push(function(){pbjs.setTargetingForGPTAsync([conf.placeholder]),googletag.pubads().refresh([conf.adslot])})})}var key,adslot;PUBLIC_STATIC.onNewAd.call(obj,conf),STATIC.adsmeta.dfp_ads+=1,STATIC.log.write("[INFO] renderPrebid called ("+PRIVATE.settings.PLATFORM+")"),adslot=googletag.defineSlot(conf.google_tag,conf.sizes,adUnitDivId).addService(googletag.pubads()),conf.viewport&&adslot.setTargeting("viewport","s"+conf.viewport);var adUnits=[{labelAny:["admanager"],code:adUnitDivId,sizes:conf.sizes,bids:conf.bids}];if(conf.adslot=adslot,conf.adslot.countRefresh=0,conf.adslot.setTargeting("refresh","0"),/^header\-ad/.test(conf.placeholder)&&window.performance&&"function"==typeof window.performance.mark)try{window.performance.mark("AD_S0_BIDDING_START")}catch(perfException){window.console&&"object"==typeof window.console&&("function"==typeof window.console.warn?window.console.warn("[AdManager] Error registering performance metric AD_S0_BIDDING_START. "+perfException.message):"function"==typeof window.console.log&&window.console.error("[AdManager] Error registering performance metric AD_S0_BIDDING_START. "+perfException.message))}if(window.pbjs.que.push(function(){window.pbjs.enableSendAllBids&&window.pbjs.enableSendAllBids(),window.pbjs.addAdUnits(adUnits)}),conf.reloaded||(STATIC.pageAds[conf.placeholder]=conf),"[object Object]"===Object.prototype.toString.call(conf.keywords)){STATIC.log.write("[INFO] Keywords was found for "+conf.placeholder+" = "+conf.google_tag);try{for(key in conf.keywords)STATIC.log.write("[INFO] Defining keyword "+key+" with value = "+conf.keywords[key].toString()),adslot.setTargeting(key,conf.keywords[key]);console.log("[AdManager] gptAdslot.setTargeting() triggered for "+conf.placeholder)}catch(error){STATIC.log.write("[ERROR] Something wrong defining keywords")}}window.pbjs.que.push(function(){window.pbjs.requestBids({labels:["admanager"],adUnitCodes:[conf.placeholder],bidsBackHandler:sendAdserverRequest,timeout:PREBID_TIMEOUT})});try{console.log("[AdManager] triggering googletag.display() for "+conf.placeholder),window.googletag.display(conf.placeholder)}catch(googletagException){console.log("[AdManager] Exception triggering display() and Refresh on GPT for "+conf.placeholder),cb.call(this,{width:0,height:0,error:"Exception triggering display() and Refresh on GPT for "+conf.placeholder})}}).then(null,function(e){STATIC.adsmeta.dfp_errors+=1,STATIC.log.write("[ERROR] Exception triggering "+conf.placeholder+": "+e.message),cb.call(obj,{width:0,height:0,error:"[ERROR] Exception triggering "+conf.placeholder,conf:conf})})):(STATIC.log.write("[ERROR] Invalid placeholder "+conf.placeholder),STATIC.ADS.length=0,void cb.call(obj,{width:0,height:0,error:"[ERROR] Invalid placeholder "+conf.placeholder,conf:conf}))},renderRubicon:function(conf,cb){var wrapper,key,callbackIndex,rubiconAdUnitName,adUnitDivId,mapping,DOMElem=(PRIVATE.settings.RUBICON_ACCOUNT_ID,new Date,document.getElementById(conf.placeholder)),obj=this;if(rubiconAdUnitName=conf.google_tag||PRIVATE.settings.DEFAULT_GOOGLE_TAG,rubiconAdUnitName=rubiconAdUnitName.replace(/^\/.+?\//,"").replace(/\./g,"_"),adUnitDivId=conf.placeholder,conf.adslot||conf.reloaded){if(!conf.reloadSize)return void STATIC.log.write("[ERROR] Reload prevented because ad size could not be detected for "+conf.placeholder);try{mapping=googletag.sizeMapping().addSize([0,0],conf.reloadSize).build(),conf.adslot=conf.adslot.defineSizeMapping(mapping)}catch(mappingException){return STATIC.log.write("[ERROR] Exception remapping slot sizes of  "+conf.placeholder+" for reload (using GPT API): "+mappingException.message),void cb.call(null,conf)}return void window.rubicontag.run(function(){if(conf.viewport&&conf.rubiconAdslot.setFPI("viewport","s"+conf.viewport),"[object Object]"===Object.prototype.toString.call(conf.keywords)){STATIC.log.write("[INFO] Keywords was found for "+conf.placeholder+" = "+conf.google_tag);try{for(key in conf.keywords)STATIC.log.write("[INFO] Defining keyword "+key+" with value = "+conf.keywords[key].toString()+" for rubicon slot."),conf.rubiconAdslot.setFPV(key,conf.keywords[key])}catch(error){STATIC.log.write("[ERROR] Something wrong defining keywords for a rubicon adslot: "+error.message)}}try{if(conf.adslot.clearTargeting(),window.rubicontag.setTargetingForGPTSlot(conf.adslot),conf.viewport&&conf.adslot.setTargeting("viewport","s"+conf.viewport),conf.adslot.setTargeting("refresh",++conf.adslot.countRefresh),"[object Object]"===Object.prototype.toString.call(conf.keywords)){STATIC.log.write("[INFO] Keywords was found for "+conf.placeholder+" = "+conf.google_tag);try{for(key in conf.keywords)STATIC.log.write("[INFO] Defining keyword "+key+" with value = "+conf.keywords[key].toString()),conf.adslot.setTargeting(key,conf.keywords[key])}catch(error){STATIC.log.write("[ERROR] Something wrong defining keywords")}}console.log("[AdManager] triggering googletag.refresh() for "+conf.placeholder),window.googletag.pubads().refresh([conf.adslot])}catch(e){STATIC.log.write("[ERROR] Exception reloading "+conf.placeholder+" (using GPT API): "+e.message),cb.call(null,conf)}},{slots:[conf.rubiconAdslot]})}return DOMElem&&"object"==typeof DOMElem&&1===DOMElem.nodeType?(wrapper=document.getElementById(conf.placeholder+"--wrapper"),wrapper||(wrapper=document.createElement("div"),wrapper.style.display="none",wrapper.id=conf.placeholder+"--wrapper",DOMElem.style.minHeight=DOMElem.style.minHeight||"1px",DOMElem.parentNode.replaceChild(wrapper,DOMElem),wrapper.appendChild(DOMElem),wrapper.style.display="block"),conf.listeners||(conf.listeners={},"function"==typeof cb&&(conf.listeners.load||(conf.listeners.load=[]),conf.listeners.load.push(cb))),conf.marks||(conf.marks={}),conf.marks.requestedByUI=new Date,void PRIVATE.getRubicon().then(function(rubicontag){var rubiconAdslot,key,adslot;if(PUBLIC_STATIC.onNewAd.call(obj,conf),STATIC.adsmeta.dfp_ads+=1,STATIC.adsmeta.onupdate(),STATIC.log.write("[INFO] renderRubicon called ("+PRIVATE.settings.PLATFORM+")"),callbackIndex=rubicontag.cmd.length-1,adslot=googletag.defineSlot(conf.google_tag,conf.sizes,adUnitDivId).addService(googletag.pubads()),conf.viewport&&adslot.setTargeting("viewport","s"+conf.viewport),conf.adslot=adslot,conf.adslot.countRefresh=0,conf.adslot.setTargeting("refresh","0"),conf.reloaded||(STATIC.pageAds[conf.placeholder]=conf),"[object Object]"===Object.prototype.toString.call(conf.keywords)){STATIC.log.write("[INFO] Keywords was found for "+conf.placeholder+" = "+conf.google_tag);try{for(key in conf.keywords)STATIC.log.write("[INFO] Defining keyword "+key+" with value = "+conf.keywords[key].toString()),adslot.setTargeting(key,conf.keywords[key]);console.log("[AdManager] gptAdslot.setTargeting() triggered for "+conf.placeholder)}catch(error){STATIC.log.write("[ERROR] Something wrong defining keywords")}}if(conf.rubiconAdslot=rubiconAdslot=window.rubicontag.defineSlot(rubiconAdUnitName,conf.sizes,adUnitDivId).setFPI("adunit",rubiconAdUnitName),console.log("[AdManager] rubiconAdslot created for "+conf.placeholder+" > rubiconAdUnitName = "+rubiconAdUnitName),conf.viewport&&conf.rubiconAdslot.setFPI("viewport","s"+conf.viewport),"[object Object]"===Object.prototype.toString.call(conf.keywords)){STATIC.log.write("[INFO] Keywords was found for "+conf.placeholder+" = "+conf.google_tag);try{for(key in conf.keywords)STATIC.log.write("[INFO] Defining keyword "+key+" with value = "+conf.keywords[key].toString()+" for rubicon slot."),conf.rubiconAdslot.setFPV(key,conf.keywords[key]);console.log("[AdManager] rubiconAdslot.setFPV() for "+conf.placeholder)}catch(error){STATIC.log.write("[ERROR] Something wrong defining keywords for a rubicon adslot: "+error.message)}}if(/^header\-ad/.test(conf.placeholder)&&window.performance&&"function"==typeof window.performance.mark)try{window.performance.mark("AD_S0_BIDDING_START")}catch(perfException){window.console&&"object"==typeof window.console&&("function"==typeof window.console.warn?window.console.warn("[AdManager] Error registering performance metric AD_S0_BIDDING_START. "+perfException.message):"function"==typeof window.console.log&&window.console.error("[AdManager] Error registering performance metric AD_S0_BIDDING_START. "+perfException.message))}window.rubicontag.run(function(){if(console.log("[AdManager] rubicon.run() callback for "+conf.placeholder),/^header\-ad/.test(conf.placeholder)&&window.performance&&"function"==typeof window.performance.mark)try{window.performance.mark("AD_S0_BIDDING_END")}catch(perfException){window.console&&"object"==typeof window.console&&("function"==typeof window.console.warn?window.console.warn("[AdManager] Error registering performance metric AD_S0_BIDDING_END. "+perfException.message):"function"==typeof window.console.log&&window.console.error("[AdManager] Error registering performance metric AD_S0_BIDDING_END. "+perfException.message))}if(STATIC.log.write("[INFO] Executing Rubicons's callbacks."),conf.adslot&&"function"==typeof window.rubicontag.setTargetingForGPTSlot)try{window.rubicontag.setTargetingForGPTSlot(conf.adslot),console.log("[AdManager] triggered rubicontag.setTargetingForGPTSlot() for "+conf.placeholder)}catch(e){STATIC.log.write("[ERROR] error calling rubicontag.setTargetingForGPTSlot()")}else STATIC.log.write("[ERROR] Rubicon was not loaded before GPT API. Something is wrong...");try{console.log("[AdManager] triggering googletag.display() for "+conf.placeholder),window.googletag.display(conf.placeholder),window.googletag.pubads().refresh([conf.adslot]),setTimeout(function(){conf.exibitions||(STATIC.adsmeta.dfp_errors+=1,STATIC.log.write("[ERROR] TIMEOUT! Unable to find the Google Iframe, or the iframe size is [1x1] for placeholder ["+conf.placeholder+"] - Time: "+((new Date).getTime()-conf.marks.requestedByUI.getTime())+"ms"),"function"==typeof cd&&cb.call(this,{width:0,height:0,error:"Timeout DFP ad",conf:conf}))},PRIVATE.settings.DFP_TIMEOUT)}catch(googletagException){console.log("[AdManager] Exception triggering display() and Refresh on GPT for "+conf.placeholder),cb.call(this,{width:0,height:0,error:"Exception triggering display() and Refresh on GPT for "+conf.placeholder})}},{slots:[conf.rubiconAdslot]})}).then(null,function(e){STATIC.adsmeta.dfp_errors+=1,STATIC.log.write("[ERROR] Exception triggering "+conf.placeholder+": "+e.message),cb.call(obj,{width:0,height:0,error:"[ERROR] Exception triggering "+conf.placeholder,conf:conf})})):(STATIC.log.write("[ERROR] Invalid placeholder "+conf.placeholder),STATIC.ADS.length=0,void cb.call(obj,{width:0,height:0,error:"[ERROR] Invalid placeholder "+conf.placeholder,conf:conf}))},renderPPI:function(conf,cb){if(STATIC.adsmeta.ppi_ads+=1,STATIC.adsmeta.onupdate(),PUBLIC_STATIC.onNewAd.call(this,conf),STATIC.pageAds[conf.placeholder]=conf,STATIC.log.write("[INFO] renderPPI called ("+PRIVATE.settings.PLATFORM+")"),PRIVATE.validatePPISettings(conf)){var _width=conf.sizes&&conf.sizes[0][0]&&conf.sizes[0][0]>0?conf.sizes[0][0]:null,_height=conf.sizes&&conf.sizes[0][1]&&conf.sizes[0][1]>0?conf.sizes[0][1]:null,time=new Date,iframeLoad=!1,placeholder=document.getElementById(conf.placeholder),wrapper=document.createElement("div");placeholder&&(wrapper.id=conf.placeholder+"--wrapper",placeholder.parentNode.replaceChild(wrapper,placeholder),wrapper.appendChild(placeholder)),STATIC.log.write("[INFO] PPI settings were validated with success");var url=PRIVATE.settings.PPI_URL+"?key="+conf.ppi_tag;STATIC.log.write("[INFO] Will render PPI ad "+conf.placeholder),STATIC.log.write("[INFO] PPI URL >>> "+url);var src=PRIVATE.env[PUBLIC_STATIC.getEnv()].htmlPath+PRIVATE.env[PUBLIC_STATIC.getEnv()].htmlFile;PRIVATE.FiF.create({placeholder:conf.placeholder,fifsrc:src,adsrc:url,width:_width,height:_height,callback:function(){var _messageppi=(new Date,"Iframe was successfully created for ad "+conf.placeholder);iframeLoad=!0,STATIC.log.write("[INFO] "+_messageppi)}}),setTimeout(function(){var newTime=new Date,_msg="[INFO] PPI AD for placeholder ["+conf.placeholder+"] was created in "+(newTime-time)+"ms";STATIC.adsmeta.ppi_success+=1,STATIC.adsmeta.onupdate(),STATIC.log.write(_msg),cb.call(this,{message:_msg,time:newTime-time+"ms",conf:conf})},0)}else{var _message="[WARN] Wrong PPI settings for ad "+conf.placeholder;STATIC.log.write(_message),cb.call(this,{message:_message,error:!0,conf:conf})}},renderGeneric:function(conf,cb){var _width=conf.sizes&&conf.sizes[0][0]&&conf.sizes[0][0]>0?conf.sizes[0][0]:null,_height=conf.sizes&&conf.sizes[0][1]&&conf.sizes[0][1]>0?conf.sizes[0][1]:null,time=new Date,iframeLoad=!1,placeholder=(PRIVATE.env[PUBLIC_STATIC.getEnv()].htmlPath+PRIVATE.env[PUBLIC_STATIC.getEnv()].htmlFile,document.getElementById(conf.placeholder)),wrapper=document.createElement("div");placeholder&&(wrapper.id=conf.placeholder+"--wrapper",placeholder.parentNode.replaceChild(wrapper,placeholder),wrapper.appendChild(placeholder)),STATIC.pageAds[conf.placeholder]=conf,STATIC.adsmeta.generic_ads+=1,STATIC.adsmeta.onupdate(),PUBLIC_STATIC.onNewAd.call(this,conf),conf.uri?PRIVATE.FiF.create({placeholder:conf.placeholder,fifsrc:conf.uri,justrender:!0,width:_width,height:_height,callback:function(){STATIC.adsmeta.generic_success+=1,STATIC.adsmeta.onupdate();var newTime=new Date,_message="Iframe was successfully created for ad "+conf.placeholder;iframeLoad=!0,STATIC.log.write("[INFO] "+_message),STATIC.log.write("[INFO] Generic AD for placeholder ["+conf.placeholder+"] was created in "+(newTime-time)+"ms"),cb.call(this,{message:_message,time:newTime-time+"ms",conf:conf})}}):STATIC.log.write("[ERROR] Invalid settings rendering generic ad server ad")},validatePPISettings:function(settings){return!!("object"==typeof settings&&settings.placeholder&&"string"==typeof settings.placeholder&&settings.ppi_tag&&"string"==typeof settings.ppi_tag&&settings.adserver&&"string"==typeof settings.adserver)},calcViewportN:function(n){STATIC.log.write("[INFO] Calculating viewport n... Was passed value = "+n);var VIEWPORT_MAX=PRIVATE.settings.VIEWPORT_MAX,VIEWPORT_ORDER=PRIVATE.settings.VIEWPORT_ORDER;return n>VIEWPORT_MAX?(n-VIEWPORT_MAX-1)%VIEWPORT_ORDER.length:n},enableViewportDebug:function(conf){if(PRIVATE.isDeubugging){var main=document.querySelector("#"+conf.placeholder),element=document.createElement("div"),adsmetaChart=document.createElement("div"),legend=document.createElement("div"),info='<div style="margin:15px"><div style="font-size:15px;font-weight:bold;"><strong><i>Viewport</i></strong>: <span style="font-size:25px">'+PRIVATE.curViewport+"</span></div>",isTiny=conf.sizes[0][0]>1&&conf.sizes[0][0]<100||conf.sizes[0][1]>1&&conf.sizes[0][1]<100,oldChartContainer=document.querySelector("#adsmetachart");oldChartContainer&&oldChartContainer.parentNode.removeChild(oldChartContainer),main&&(main.style.position=isTiny?"absolute":"relative"),element.style.position=isTiny?"":"absolute";for(var i in conf)"function"!=typeof conf[i]&&(conf[i]="object"==typeof conf[i]?JSON.stringify(conf[i]):conf[i],info+="<div><strong><i>"+i+"</i></strong> : "+conf[i]+"<div>");info+="</div>",element.style.zIndex="99999999",element.style.top="0px",element.style.left="0px",element.style.width="100%",element.style.height="100%",element.style.background="rgb(243, 234, 18)",element.style.overflow="auto",element.style.fontSize="12px",element.style.textAlign="left",element.style.opacity="0.8",element.innerHTML=info,adsmetaChart.id="adsmetachart",adsmetaChart.style.position="fixed",adsmetaChart.style.top="15px",adsmetaChart.style.left="400px",adsmetaChart.style.width="200px",adsmetaChart.style.height="200px",adsmetaChart.style.zIndex="9999999999",legend.id="chart_legend",legend.style.position="fixed",legend.style.top="15px",legend.style.background="#fff",legend.style.left="610px",legend.style.width="110px",legend.style.padding="8px",legend.style.height="90px",legend.innerHTML='<div style="color:rgb(102, 0, 127); font-weight:bold">DFP Success</div><div style="color:rgb(168, 111, 65); font-weight:bold">DFP Errors</div><div style="color:rgb(41, 84, 84); font-weight:bold">PPI Success</div><div style="color:rgb(153, 106, 178); font-weight:bold">PPI Errors</div>',legend.style.zIndex="9999999999",document.body.appendChild(legend),document.body.appendChild(adsmetaChart),main&&main.appendChild(element),STATIC.adsmeta.onupdate(function(){var oldContainer=document.querySelector("#adsmeta");oldContainer&&oldContainer.parentNode.removeChild(oldContainer);var container=document.createElement("div"),adsmeta=STATIC.adsmeta,totalAds=adsmeta.dfp_ads+adsmeta.ppi_ads,totalDFP=adsmeta.dfp_ads,DFPsuccess=adsmeta.dfp_success,DFPsucessP=totalDFP>0?Math.round(100*DFPsuccess/totalDFP):0,DFPerrors=adsmeta.dfp_errors,DFPerrorsP=totalDFP>0?Math.round(100*DFPerrors/totalDFP):0,totalPPI=adsmeta.ppi_ads,PPIsuccess=adsmeta.ppi_success,PPIsuccessP=totalPPI>0?Math.round(100*PPIsuccess/totalPPI):0,PPIerrors=adsmeta.ppi_errors,PPIerrorsP=totalPPI>0?Math.round(100*PPIerrors/totalPPI):0,totalSuccess=DFPsuccess+PPIsuccess,totalSuccessP=totalAds>0?Math.round(100*totalSuccess/totalAds):0,totalErrors=DFPerrors+PPIerrors,totalErrorsP=totalAds>0?Math.round(100*totalErrors/totalAds):0;adsmeta.total=totalAds,adsmeta.dfp_success_percent=DFPsucessP,adsmeta.dfp_errors_percent=DFPerrorsP,adsmeta.ppi_success_percent=PPIsuccessP,adsmeta.ppi_errors_percent=PPIerrorsP,adsmeta.total_success=totalSuccess,adsmeta.total_success_percent=totalSuccessP,adsmeta.total_errors=totalErrors,adsmeta.total_errors_percent=totalErrorsP,container.style.position="fixed",container.style.top="0px",container.style.left="0px",container.style.width="730px",container.style.height="220px",container.style.padding="15px",container.style.margin="5px",container.style.color="#fff",container.id="adsmeta",container.style.backgroundColor="#000",container.style.zIndex="99999999",container.innerHTML='<div style="float:left;margin-right:20px";padding-right;padding-right:20px;border-left:solid 1px gray><div>Total Ads: <span style="font-size:15px"> '+totalAds+'</span></div><div>Total DFP: <span style="font-size:15px"> '+totalDFP+'</span></div><div>DFP Success: <span style="font-size:15px;color:rgb(13, 105, 5);font-weight:bold">&nbsp;'+DFPsuccess+"</span><span> ("+DFPsucessP+'%)</span></div><div>DFP Errors: <span style="font-size:15px;color:rgb(240, 9, 37);font-weight:bold">&nbsp;'+DFPerrors+"</span><span> ("+DFPerrorsP+'%)</span></div><div>Total PPI: <span style="font-size:15px"> '+totalPPI+'</span></div><div>PPI Success: <span style="font-size:15px;color:rgb(13, 105, 5);font-weight:bold">&nbsp;'+PPIsuccess+"</span><span> ("+PPIsuccessP+'%)</span></div><div>PPI Errors: <span style="font-size:15px;color:rgb(240, 9, 37);font-weight:bold">&nbsp;'+PPIerrors+"</span><span> ("+PPIerrorsP+'%)</span></div></div><div style="float:left;"><div>Total Success: <span style="font-size:15px;color:rgb(13, 105, 5);font-weight:bold">&nbsp;'+totalSuccess+"</span><span> ("+totalSuccessP+'%)</span></div><div>Total Errors: <span style="font-size:15px;color:rgb(240, 9, 37);font-weight:bold">&nbsp;'+totalErrors+"</span><span> ("+totalErrorsP+"%)</span></div><div>",document.body.appendChild(container),PRIVATE.Util.renderDebugChart(STATIC.adsmeta)})}},loadTagmanScript:function(conf){var promise=new Promise(function(resolve,reject){var util=PRIVATE.Util,url=null,includeTimeout=!1,time=new Date;if(STATIC.ADS.length=0,conf&&conf.area&&"string"==typeof conf.area){url=PRIVATE.env[PUBLIC_STATIC.getEnv()].tagmanURL+"?key="+(conf.tgmkey?conf.tgmkey:PRIVATE.settings.TGMKEY)+"."+conf.area+"&direct=1",STATIC.log.write("[INFO] GET URL >>> "+url);var stickInterval=setInterval(function(){STATIC.stickAdRunning||(STATIC.ADS.length=0,STATIC.stickAdRunning=!0,util.includeJS(url,function(){var newTime=new Date;STATIC.log.write("[INFO] OK - GET URL >>> "+url+"["+(newTime-time)+"ms]"),includeTimeout=!0,resolve({ADS:PRIVATE.clone(STATIC.ADS)}),STATIC.ADS.length=0,STATIC.stickAdRunning=!1,clearInterval(stickInterval)},function(){STATIC.log.write("[ERROR] FAIL - GET URL >>> "+url),STATIC.ADS.length=0,STATIC.stickAdRunning=!1,clearInterval(stickInterval)}),STATIC.log.write("[INFO] Starting TAGMAN timeout checker...will wait "+PRIVATE.settings.TAGMAN_TIMEOUT+"ms for this request"),setTimeout(function(){if(!includeTimeout){STATIC.ADS.length=0;var newTime=new Date,message="TAGMAN TIMEOUT - The url "+url+" took to long to load. None ads was delivered ["+(newTime-time)+"ms].";STATIC.log.write("[ERROR] "+message),reject({error:message}),STATIC.stickAdRunning=!1,clearInterval(stickInterval),PUBLIC_STATIC.onError.call(this,{conf:conf,msg:message})}},PRIVATE.settings.TAGMAN_TIMEOUT))},200)}});return promise},injectAdSettings:function(ad){var obj={reload:!0,loop:35e3,type:"all",times:6,app:"core"};return ad.reloadRule=obj,ad},metrics:{run:!1,randomMetric:function(){return Math.ceil(100*Math.random())<=PRIVATE.settings.ADS_METRICS_PERCENTAGE},init:function(){STATIC.log||(STATIC.log=new PRIVATE.Log("zaz-admanager")),STATIC.log.write("[INFO] Initializing metrics");var chosen=PRIVATE.metrics.randomMetric();STATIC.log.write("[INFO] This session was chosen? "+chosen),PUBLIC_STATIC.onNewAd(function(){STATIC.log.write("[INFO] newAd listener fired");var ads=STATIC.adsmeta,total=ads.dfp_ads+ads.ppi_ads+ads.generic_ads;total>=PRIVATE.settings.ADS_METRICS_PUSH&&chosen&&!PRIVATE.metrics.run&&(PRIVATE.metrics.post(),PRIVATE.metrics.run=!0)})},post:function(){var postData="",ads=STATIC.adsmeta;STATIC.log.write("[INFO] Will post data to metrics"),postData=ads.dfp_success+","+ads.dfp_errors+","+ads.ppi_success+","+ads.ppi_errors,STATIC.log.write("[INFO] Metrics: "+postData),"function"==typeof terra_stats_regMetrics&&terra_stats_regMetrics({type:"TD",time:postData})}},init:function(){PRIVATE.initOnce=!0,PRIVATE.initialize(),PRIVATE.getGPT()}};PRIVATE.settings.TGMKEY=PRIVATE.getTgmKey(),PUBLIC_STATIC=AdManager=function AdManager(obj){var lib=PRIVATE;lib.Util;obj&&obj.debug&&(this.PRIVATE_METHODS=PRIVATE),STATIC.log||(STATIC.log=new PRIVATE.Log("zaz-admanager"),STATIC.log.write("[INFO] New AdManager instance")),STATIC.instances.push(this),PRIVATE.initOnce||PRIVATE.init(),this.getViewportAds=function(viewportN){var promise,that=this,settings=PRIVATE.settings,util=PRIVATE.Util;return promise=PRIVATE.setup({tgmkey:settings.tgmkey}).then(function(){return new Promise(function(resolve,reject){var viewport=viewportN>settings.VIEWPORT_MAX?settings.VIEWPORT_ORDER[PRIVATE.calcViewportN(viewportN)]:viewportN,url=null,includeTimeout=!1,extendFn=function(data){if(data.reloadRule){STATIC.log.write("[WARN] Extending "+this.placeholder);try{this.reloadRule=data.reloadRule}catch(e){STATIC.log.write("[EROR]"+e)}}else STATIC.log.write("[ERROR] Invalid extend data")},backendViewport=AdManager.get("backend_getviewport");if(PRIVATE.curViewport=viewportN,that.tgmkey&&(PRIVATE.settings.TGMKEY=that.tgmkey),url=STATIC.mock?"../mock/s"+viewport+".js":PRIVATE.env[PUBLIC_STATIC.getEnv()].tagmanURL+"?key="+PRIVATE.settings.TGMKEY+".s"+viewport+"&direct=1",PRIVATE.settings.NO_ADS)return STATIC.log.write("[WARN] HEY, JUST TO INFORM YOU: I'M IGNORING ADVERTISING. WHY? BECAUSE IT WAS DISABLED BY THE URL PARAMETER(noads)."),void resolve({ADS:[]});if(null!==PRIVATE.settings.TGMKEY||that.tgmkey||reject("Invalid TGMKEY"),viewportN&&"number"==typeof viewportN||reject("Invalid viewport number"),"object"==typeof backendViewport&&backendViewport["s"+viewport]&&"function"==typeof backendViewport["s"+viewport]&&STATIC.tgmKeyHasChanged<=1){STATIC.log.write("[INFO] Backend ADS, this request is already cached >>> "+url);try{STATIC.viewportAds[PRIVATE.settings.TGMKEY+"_"+viewportN]=[],backendViewport["s"+viewport].apply(this)}catch(e){STATIC.log.write("[ERROR] Something wrong with the cached request >>> "+url),reject({error:"s"+viewport+" ERROR | "+e})}STATIC.viewportAds[PRIVATE.settings.TGMKEY+"_"+viewportN]||(STATIC.viewportAds[PRIVATE.settings.TGMKEY+"_"+viewportN]=[]);for(var y in STATIC.ads)STATIC.ads[y].platform===PRIVATE.settings.PLATFORM&&(STATIC.ads[y].extend=extendFn,STATIC.ads[y].viewport=viewportN,STATIC.viewportAds[PRIVATE.settings.TGMKEY+"_"+viewportN].push(STATIC.ads[y]));STATIC.ads={},resolve({instance:that,ADS:STATIC.viewportAds[PRIVATE.settings.TGMKEY+"_"+viewportN]})}else STATIC.log.write("[INFO] GET URL >>> "+url),util.includeJS(url,function(){STATIC.log.write("[INFO] OK - GET URL >>> "+url);var extendFn=function(data){if(data.reloadRule){STATIC.log.write("[WARN] Extending "+this.placeholder);try{this.reloadRule=data.reloadRule}catch(e){STATIC.log.write("[EROR]"+e)}}else STATIC.log.write("[ERROR] Invalid extend data")};STATIC.ADS.length;STATIC.viewportAds[PRIVATE.settings.TGMKEY+"_"+viewportN]||(STATIC.viewportAds[PRIVATE.settings.TGMKEY+"_"+viewportN]=[]);for(var y in STATIC.ads)STATIC.ads[y].platform===PRIVATE.settings.PLATFORM&&(STATIC.ads[y].extend=extendFn,STATIC.ads[y].viewport=viewportN,STATIC.viewportAds[PRIVATE.settings.TGMKEY+"_"+viewportN].push(STATIC.ads[y]));STATIC.ads={},includeTimeout=!0,resolve({instance:that,ADS:STATIC.viewportAds[PRIVATE.settings.TGMKEY+"_"+viewportN]})},function(e){STATIC.log.write("[ERROR] FAIL - GET URL >>> "+url),STATIC.ads={};var err={error:"[TAGMAN REQUEST ERROR]"};reject(err),PUBLIC_STATIC.onError.call(this,err)}),STATIC.log.write("[INFO] Starting TAGMAN timeout checker...will wait "+settings.TAGMAN_TIMEOUT+"ms for this request"),setTimeout(function(){if(!includeTimeout){STATIC.ads={};var message="TAGMAN TIMEOUT - The url "+url+" took to long to load. None ads was delivered.";STATIC.log.write("[ERROR] "+message),reject({error:message}),PUBLIC_STATIC.onError.call(this,message)}},settings.TAGMAN_TIMEOUT)})})},this.preloadArea=function(area){var _url=null,_id="stickad_"+PRIVATE.uid();return _url=PRIVATE.env[PUBLIC_STATIC.getEnv()].tagmanURL+"?key="+PRIVATE.settings.TGMKEY+"."+area+"&direct=1",PUBLIC_STATIC.load3rdPartyCode({url:_url,id:_id,meta:{}})},this.renderAd=function(conf){return new Promise(function(resolve,reject){var switchAds=function(ad,cb){var er={};if("dfp"!==ad.adserver||ad.platform!==PRIVATE.settings.PLATFORM&&"responsive"!==ad.platform)"ppi"===ad.adserver&&ad.platform===PRIVATE.settings.PLATFORM||"responsive"===ad.platform?(STATIC.log.write("[INFO] Rendering PPI ad..."),PRIVATE.renderPPI(ad,function(meta){if(meta.error?(er.error=meta.error,PUBLIC_STATIC.onError.call(this,meta)):ad.time=meta.time,PRIVATE.enableViewportDebug(ad),ad.onresize&&"function"==typeof ad.onresize){STATIC.log.write("[WARN] onresize listener started for "+ad.placeholder);var DOMElem=document.getElementById("fif_"+ad.placeholder).contentWindow.document.getElementById("FiF_container"),firstHeight=DOMElem.clientHeight,firsttWidth=DOMElem.clientWidth;setInterval(function(){var currentHeight=DOMElem.clientHeight,currentWidth=DOMElem.clientWidth;firsttWidth!==currentWidth&&(STATIC.log.write("[WARN] Advertising resize listener fired. Width has changed ["+ad.placeholder+"] to "+currentWidth),firsttWidth=currentWidth,ad.onresize.call(this,{width:currentWidth})),firstHeight!==currentHeight&&(STATIC.log.write("[WARN] Advertising resize listener fired. Height has changed ["+ad.placeholder+"] to "+currentHeight),firstHeight=currentHeight,ad.onresize.call(this,{height:currentHeight}))},200)}cb.call(this,er.error?er.error:ad)})):("uri"===ad.adserver&&ad.platform===PRIVATE.settings.PLATFORM||"responsive"===ad.platform)&&(STATIC.log.write("[INFO] Rendering uri ad"),PRIVATE.renderGeneric(ad,function(meta){meta.error?(er.error=meta.error,PUBLIC_STATIC.onError.call(this,meta)):ad.time=meta.time,PRIVATE.enableViewportDebug(ad),cb.call(this,er.error?er.error:ad)}));else{if("object"!=typeof ad)return void STATIC.log.write("[ERROR] Bad ad configuration");STATIC.log.write("[INFO] Rendering DFP ad..."),PRIVATE.renderDFP(ad,function(data){if(data.error&&(er.error=data.error,PUBLIC_STATIC.onError.call(this,data)),ad.width=parseInt(data.width,10),ad.height=parseInt(data.height,10),ad.error=data.error,ad.time=data.time,PRIVATE.enableViewportDebug(ad),ad.onresize&&"function"==typeof ad.onresize){STATIC.log.write("[WARN] onresize listener started for "+ad.placeholder);var DOMElem=document.getElementById(ad.placeholder),firsttWidth=DOMElem.clientWidth,firstHeight=DOMElem.clientHeight;setInterval(function(){var currentWidth=DOMElem.clientWidth,currentHeight=DOMElem.clientHeight;firsttWidth!==currentWidth&&(STATIC.log.write("[WARN] Advertising resize listener fired. Width has changed ["+ad.placeholder+"] to "+currentWidth),firsttWidth=currentWidth,ad.onresize.call(this,{width:currentWidth})),firstHeight!==currentHeight&&(STATIC.log.write("[WARN] Advertising resize listener fired. Height has changed ["+ad.placeholder+"] to "+currentHeight),firstHeight=currentHeight,ad.onresize.call(this,{height:currentHeight}))},200)}cb.call(this,er.error?er.error:ad)})}},ad=null;switchAds(conf,function(data){STATIC.ADS.length=0,ad=data,ad.error&&reject(ad.error),resolve(ad)})})},this.createAds=function(conf){function addResize(conf,ppi){var DOMElem,firsttWidth,firstHeight;if(conf.onresize&&"function"==typeof conf.onresize){STATIC.log.write("[WARN] onresize listener started for "+conf.placeholder);try{DOMElem=ppi?document.getElementById("fif_"+conf.placeholder).contentWindow.document.getElementById("FiF_container"):document.getElementById(conf.placeholder)}catch(e){STATIC.log.write("[ERROR] Impossible to create a resize listener: container not found ["+conf.placeholder+"]")}if(!DOMElem||"object"!=typeof DOMElem)return;firsttWidth=DOMElem.clientWidth,firstHeight=DOMElem.clientHeight;setInterval(function(){var currentWidth=DOMElem.clientWidth,currentHeight=DOMElem.clientHeight;firsttWidth!==currentWidth&&(STATIC.log.write("[WARN] Advertising resize listener fired. Width has changed ["+conf.placeholder+"] to "+currentWidth),firsttWidth=currentWidth,conf.onresize.call(this,{width:currentWidth})),firstHeight!==currentHeight&&(STATIC.log.write("[WARN] Advertising resize listener fired. Height has changed ["+conf.placeholder+"] to "+currentHeight),firstHeight=currentHeight,conf.onresize.call(this,{height:currentHeight}))},200)}}function switchAds(i){PRIVATE.checkReloadRules(conf.ADS[i],conf.ADS),function(y){if("prebid"!==conf.ADS[y].adserver||conf.ADS[y].platform!==PRIVATE.settings.PLATFORM&&"responsive"!==conf.ADS[y].platform)if("rubicon"!==conf.ADS[y].adserver||conf.ADS[y].platform!==PRIVATE.settings.PLATFORM&&"responsive"!==conf.ADS[y].platform)if("dfp"!==conf.ADS[y].adserver||conf.ADS[y].platform!==PRIVATE.settings.PLATFORM&&"responsive"!==conf.ADS[y].platform)"ppi"===conf.ADS[y].adserver&&conf.ADS[y].platform===PRIVATE.settings.PLATFORM||"responsive"===conf.ADS[y].platform?(STATIC.log.write("[INFO] Rendering PPI ad..."),returnedAds.push(new Promise(function(resolve,reject){PRIVATE.renderPPI(conf.ADS[y],function(meta){meta.error?(STATIC.ADS.length=0,Promise.reject(meta.error),PUBLIC_STATIC.onError.call(this,meta)):(conf.ADS[y].time=meta.time,STATIC.ADS.length=0,resolve(conf.ADS[y])),PRIVATE.enableViewportDebug(conf.ADS[y]),addResize(conf.ADS[y],!0)})}))):("uri"===conf.ADS[y].adserver&&conf.ADS[y].platform===PRIVATE.settings.PLATFORM||"responsive"===conf.ADS[y].platform)&&(STATIC.log.write("[INFO] Rendering uri ad"),returnedAds.push(new Promise(function(resolve,reject){PRIVATE.renderGeneric(conf.ADS[y],function(meta){meta.error?(STATIC.ADS.length=0,Promise.reject(meta.error),PUBLIC_STATIC.onError.call(this,meta)):(conf.ADS[y].time=meta.time,STATIC.ADS.length=0,resolve(conf.ADS[y])),PRIVATE.enableViewportDebug(conf.ADS[y])})})));else{if("object"!=typeof conf.ADS[y])return void STATIC.log.write("[ERROR] Bad ad configuration");STATIC.log.write("[INFO] Rendering DFP ad..."),returnedAds.push(new Promise(function(resolve,reject){PRIVATE.renderDFP(conf.ADS[y],function(data){data.error&&(STATIC.ADS.length=0,Promise.reject(data.error),PUBLIC_STATIC.onError.call(this,data)),conf.ADS[y].width=data.width,conf.ADS[y].height=data.height,conf.ADS[y].error=data.error,conf.ADS[y].time=data.time,STATIC.ADS.length=0,PRIVATE.enableViewportDebug(conf.ADS[y]),
resolve(conf.ADS[y])})})),addResize(conf.ADS[y])}else{if("object"!=typeof conf.ADS[y])return void STATIC.log.write("[ERROR] Bad ad configuration");STATIC.log.write("[INFO] Rendering Rubicon ad..."),returnedAds.push(new Promise(function(resolve,reject){PRIVATE.renderRubicon(conf.ADS[y],function(data){data.error&&(STATIC.ADS.length=0,Promise.reject(data.error),PUBLIC_STATIC.onError.call(this,data)),conf.ADS[y].width=data.width,conf.ADS[y].height=data.height,conf.ADS[y].error=data.error,conf.ADS[y].time=data.time,STATIC.ADS.length=0,PRIVATE.enableViewportDebug(conf.ADS[y]),resolve(conf.ADS[y])})})),addResize(conf.ADS[y])}else{if("object"!=typeof conf.ADS[y])return void STATIC.log.write("[ERROR] Bad ad configuration");STATIC.log.write("[INFO] Rendering Prebid ad..."),returnedAds.push(new Promise(function(resolve,reject){PRIVATE.renderPrebid(conf.ADS[y],function(data){data.error&&(STATIC.ADS.length=0,Promise.reject(data.error),PUBLIC_STATIC.onError.call(this,data)),conf.ADS[y].width=data.width,conf.ADS[y].height=data.height,conf.ADS[y].error=data.error,conf.ADS[y].time=data.time,STATIC.ADS.length=0,PRIVATE.enableViewportDebug(conf.ADS[y]),resolve(conf.ADS[y])})})),addResize(conf.ADS[y])}}(i)}var returnedAds=[];if(!conf||"object"!=typeof conf||"[object Array]"!=Object.prototype.toString.call(conf.ADS)||!conf.ADS.length)throw new Error("Invalid ad configuration array");var current,adsLen=conf.ADS.length,i=0;if(adsLen>0)for(i;adsLen>i;i+=1)current=conf.ADS[i],current&&"object"==typeof current?current.placeholder&&"string"==typeof current.placeholder&&document.getElementById(current.placeholder)?STATIC.pageAds[current.placeholder]?STATIC.log.write("[WARN] Discarting item passed to createdAds. Ad already created: "+current.placeholder):switchAds(i):STATIC.log.write("[WARN] Discarting item passed to createdAds. Invalid placeholder: "+current.placeholder):STATIC.log.write("[WARN] Discarting item passed to createdAds. Invalid configuration object.");else STATIC.log.write("[ERROR] None DFP ads found"),STATIC.adsmeta.dfp_errors+=1,STATIC.ADS.length=0;return Promise.all(returnedAds)},this.stickAd=function(conf){var promise;return STATIC.log.write("[INFO] stickAd() method was called ("+PRIVATE.settings.PLATFORM+") - area: "+conf.area?conf.area:"null"),promise=PRIVATE.setup({tgmkey:conf.tgmkey}).then(function(){return new Promise(function(resolve,reject){if(PRIVATE.settings.NO_ADS)return STATIC.log.write("[WARN] HEY, JUST TO INFORM YOU: I'M IGNORING ADVERTISING. WHY? BECAUSE IT WAS DISABLED BY THE URL PARAMETER(noads)."),void resolve({ADS:[]});if(conf&&conf.placeholder&&"object"==typeof conf.placeholder&&conf.placeholder.id&&conf.area&&"string"==typeof conf.area){var _url=null,_id="stickad_"+PRIVATE.uid();_url=STATIC.mock?"../mock/"+conf.area+".js":PRIVATE.env[PUBLIC_STATIC.getEnv()].tagmanURL+"?key="+(conf.tgmkey?conf.tgmkey:PRIVATE.settings.TGMKEY)+"."+conf.area+"&direct=1",PUBLIC_STATIC.load3rdPartyCode({url:_url,id:_id,meta:{placeholder:conf.placeholder.id,area:conf.area}}).then(function(iFrameScope){resolve(iFrameScope)},function(errormessage){reject(errormessage)})}else{var errormessage="stickAd method configuration error. You probably forget to provide a required property";STATIC.log.write("[ERROR]"+errormessage),reject({error:errormessage})}})})}},PUBLIC_STATIC.outOfPage=function(conf){PRIVATE.getGPT().then(function(){var elemID="out-of-page-terra-ad";if(!document.getElementById(elemID)){var elem=document.createElement("div");elem.setAttribute("id",elemID),document.getElementsByTagName("body")[0].appendChild(elem),window.googletag.cmd.push(function(){var slot=googletag.defineOutOfPageSlot(top.AdManager.get("google_tag"),elemID);if(slot.addService(googletag.pubads()),conf)for(var i=0;i<Object.keys(conf).length;i++)slot.setTargeting(Object.keys(conf)[i],conf[Object.keys(conf)[i]]);window.googletag.pubads().refresh([slot]),window.googletag.display(elemID),window.googletag.enableServices()})}})},PUBLIC_STATIC.defineAd=function(config,meta){var id="AdManager_"+Math.random().toString(32).slice(2);if(!config||"object"!=typeof config)throw"Invalid ad configuration";config.id=id,!config.single||config.single!==!0&&"true"!==config.single?(STATIC.log.write('[INFO] Static method "defineAd" was called passing this configuration: '+JSON.stringify(config)),STATIC.ADS.push(config),STATIC.ads[id]=config):(STATIC.log.write("[INFO] isolated rendering single call: "+JSON.stringify(config)),config.platform!==PRIVATE.settings.PLATFORM&&"responsive"!==config.platform||(config.placeholder=meta&&meta.placeholder?meta.placeholder:null,STATIC.log.write("[INFO] isolated rendering of "+config.adserver),PRIVATE.render(config,function(data){config.time=data.time,PRIVATE.enableViewportDebug(config)})))},PUBLIC_STATIC.load3rdPartyCode=function(settings){STATIC.log||(STATIC.log=new PRIVATE.Log("zaz-admanager")),STATIC.log.write("[WARN] load3rdPartyCode method was called with >>> "+JSON.stringify(settings));var promise=new Promise(function(resolve,reject){var placeholder=document.createElement("div"),id=settings.id?settings.id:"admanager-3rdpartycode-sandbox-"+PRIVATE.uid(),timeout=!0,errormessage="[ERROR] load3rdPartyCode TIMEOUT";placeholder.id=id,placeholder.style.cssText="width:1px; height:1px;position:absolute;visibility:hidden",document.body.appendChild(placeholder),PRIVATE.FiF.create({placeholder:placeholder.id,fifsrc:PRIVATE.env[PUBLIC_STATIC.getEnv()].htmlPath+PRIVATE.env[PUBLIC_STATIC.getEnv()].htmlFile,adsrc:settings.url,width:"1",height:"1",meta:settings.meta?settings.meta:null,callback:function(){timeout=!1,STATIC.log.write("[INFO] 3rdPartyCode was loaded successfully"),document.getElementById("fif_"+id).contentWindow.name=id,resolve(document.getElementById("fif_"+id).contentWindow)}}),setTimeout(function(){if(timeout===!0){var sandboxDOMElem=document.getElementById(id);STATIC.log.write("[ERROR] "+errormessage),reject({error:errormessage}),PUBLIC_STATIC.onError.call(this,{errormessage:errormessage,conf:settings}),sandboxDOMElem.parentNode.removeChild(sandboxDOMElem)}},PRIVATE.settings.THIRDPARTY_TIMEOUT)});return promise},PUBLIC_STATIC.removeCurrentInstances=function(){PRIVATE.error("All instances were removed"),STATIC.instances=[]},PUBLIC_STATIC.getCurrentInstances=function(){return STATIC.instances},PUBLIC_STATIC.get=function(key){STATIC.log||(STATIC.log=new PRIVATE.Log("zaz-admanager")),STATIC.log.write("[INFO] Static get method was called for key "+key);var attribute=STATIC.attributes[key];return"function"==typeof attribute?attribute.call(this):attribute},PUBLIC_STATIC.set=function(key,value){STATIC.log||(STATIC.log=new PRIVATE.Log("zaz-admanager")),STATIC.log.write("[INFO] Static set method was called for key "+key),key&&value&&(STATIC.attributes[key]=value,/setup_done_for_.+/.test(key)&&PRIVATE.setup({tgmkey:key.replace("setup_done_for_","")}))},PUBLIC_STATIC.getConfig=function(){return{env:PRIVATE.env[PUBLIC_STATIC.getEnv()],settings:PRIVATE.settings}},PUBLIC_STATIC.addFilter=function(obj){"object"==typeof obj&&obj.name&&obj.fn&&"function"==typeof obj.fn?(STATIC.log&&STATIC.log.write("[WARN] Public method addFilter was called with >>> "+JSON.stringify(obj)),STATIC.filters.push(obj)):STATIC.log.write("[WARN] Invalid filter configuration")},PUBLIC_STATIC.listFilters=function(){return STATIC.filters},PUBLIC_STATIC.execFilter=function(name,params){var filters=STATIC.filters,len=filters.length,i=0;if(name){for(;len>i;i+=1)if(name===filters[i].name)return STATIC.log.write("[INFO] Filter "+name+" was called with params: "+JSON.stringify(params)),filters[i].fn.call(this,params);STATIC.log.write("[WARN] Filter "+name+" was not found")}},PUBLIC_STATIC.setEnv=function(env){!env||"prd"!==env&&"dsv"!==env?STATIC.log.write("[ERROR] Invalid environment"):(STATIC.log||(STATIC.log=new PRIVATE.Log("zaz-admanager")),STATIC.log.write("[WARN] Changing environment to "+env),PRIVATE.curEnv=env)},PUBLIC_STATIC.getEnv=function(){return PRIVATE.curEnv},PUBLIC_STATIC.getCurrentViewport=function(){return PRIVATE.curViewport},PUBLIC_STATIC.configure=function(obj){if(STATIC.log||(STATIC.log=new PRIVATE.Log("zaz-admanager")),STATIC.log.write("[WARN] Public method configure was called..."),"object"!=typeof obj)throw"Invalid object configuration";obj.VIEWPORT_MAX&&obj.VIEWPORT_MAX>0&&(PRIVATE.settings.VIEWPORT_MAX=obj.VIEWPORT_MAX,STATIC.log.write("[WARN] Changing VIEWPORT_MAX to "+obj.VIEWPORT_MAX)),obj.DEFAULT_GOOGLE_TAG&&"string"==typeof obj.DEFAULT_GOOGLE_TAG&&(PRIVATE.settings.DEFAULT_GOOGLE_TAG=obj.DEFAULT_GOOGLE_TAG,STATIC.log.write("[WARN] Changing DEFAULT_GOOGLE_TAG to "+obj.DEFAULT_GOOGLE_TAG)),obj.DFP_TIMEOUT&&"number"==typeof obj.DFP_TIMEOUT&&(PRIVATE.settings.DFP_TIMEOUT=obj.DFP_TIMEOUT,STATIC.log.write("[WARN] Changing DFP_TIMEOUT to "+obj.DFP_TIMEOUT)),obj.TAGMAN_TIMEOUT&&"number"==typeof obj.TAGMAN_TIMEOUT&&(PRIVATE.settings.TAGMAN_TIMEOUT=obj.TAGMAN_TIMEOUT,STATIC.log.write("[WARN] Changing TAGMAN_TIMEOUT to "+obj.TAGMAN_TIMEOUT)),obj.PPI_TIMEOUT&&"number"==typeof obj.PPI_TIMEOUT&&(PRIVATE.settings.PPI_TIMEOUT=obj.PPI_TIMEOUT,STATIC.log.write("[WARN] Changing PPI_TIMEOUT to "+obj.PPI_TIMEOUT)),obj.THIRDPARTY_TIMEOUT&&"number"==typeof obj.THIRDPARTY_TIMEOUT&&(PRIVATE.settings.THIRDPARTY_TIMEOUT=obj.THIRDPARTY_TIMEOUT,STATIC.log.write("[WARN] Changing THIRDPARTY_TIMEOUT to "+obj.THIRDPARTY_TIMEOUT)),obj.DFP_IFRAME_INTERVAL_CHECKER&&"number"==typeof obj.DFP_IFRAME_INTERVAL_CHECKER&&(PRIVATE.settings.DFP_IFRAME_INTERVAL_CHECKER=obj.DFP_IFRAME_INTERVAL_CHECKER,STATIC.log.write("[WARN] Changing DFP_IFRAME_INTERVAL_CHECKER to "+obj.DFP_IFRAME_INTERVAL_CHECKER)),obj.htmlPath&&"string"==typeof obj.htmlPath&&(PRIVATE.env[PUBLIC_STATIC.getEnv()].htmlPath=obj.htmlPath,STATIC.log.write("[WARN] Changing htmlPath to "+obj.htmlPath)),obj.VIEWPORT_ORDER&&"object"==typeof obj.VIEWPORT_ORDER&&obj.VIEWPORT_ORDER.length>0&&(PRIVATE.settings.VIEWPORT_ORDER=obj.VIEWPORT_ORDER,STATIC.log.write("[WARN] Changing VIEWPORT_ORDER to "+obj.VIEWPORT_ORDER)),obj.TGMKEY&&(STATIC.tgmKeyHasChanged+=1,PRIVATE.lockTgmKeyChange?STATIC.log.write("[WARN] Attempt to change tgmkey was denied. Tgmkey parameter is present on the URL "+obj.TGMKEY):(PRIVATE.settings.TGMKEY=obj.TGMKEY,STATIC.log.write("[WARN] Changing TGMKEY to "+obj.TGMKEY))),obj.PLATFORM&&("mob"===obj.PLATFORM||"web"===obj.PLATFORM||"tab"===obj.PLATFORM||"responsive"===obj.PLATFORM?(PRIVATE.settings.PLATFORM=obj.PLATFORM,STATIC.log.write("[WARN] Changing PLATFORM to "+obj.PLATFORM)):STATIC.log.write("[ERROR] Invalid platform: "+obj.PLATFORM)),obj.TAGMAN_URL&&(PRIVATE.env[PUBLIC_STATIC.getEnv()].tagmanURL=obj.TAGMAN_URL,PRIVATE.settings.TAGMAN_URL=obj.TAGMAN_URL,STATIC.log.write("[WARN] Changing TAGMAN_URL to "+obj.TAGMAN_URL)),obj.ADS_METRICS_PUSH&&(obj.ADS_METRICS_PUSH&&"number"==typeof obj.ADS_METRICS_PUSH?(PRIVATE.settings.ADS_METRICS_PUSH=obj.ADS_METRICS_PUSH,STATIC.log.write("[WARN] Changing ADS_METRICS_PUSH to "+obj.ADS_METRICS_PUSH)):STATIC.log.write("[ERROR] Error changing ADS_METRICS_PUSH - Invalid parameter"))},PUBLIC_STATIC.setLogHandler=function(fn){return STATIC.log.setHandler(fn)},PUBLIC_STATIC.debug=function(){PRIVATE.Util.initYUIConsole(),PRIVATE.isDeubugging=!0},PUBLIC_STATIC.getMetadata=function(){return STATIC.adsmeta},PUBLIC_STATIC.useMock=function(){STATIC.log||(STATIC.log=new PRIVATE.Log("zaz-admanager")),STATIC.log.write("[WARN] HEY! I'm just entering in MOCK MODE. Stay tuned ¬¬"),STATIC.mock=!0},PUBLIC_STATIC.postMetrics=function(){PRIVATE.metrics.post()},PUBLIC_STATIC.onNewAd=function(fn){STATIC.onNewAdList||(STATIC.onNewAdList=[]),STATIC.onNewAdList.push(fn);for(var i=0;i<STATIC.onNewAdList.length;i+=1)"function"==typeof STATIC.onNewAdList[i]&&STATIC.onNewAdList[i].apply()},PUBLIC_STATIC.onError=function(p){if("function"==typeof p)STATIC.onErrorAdList||(STATIC.onErrorAdList=[]),STATIC.onErrorAdList.push(p);else if(STATIC.onErrorAdList&&STATIC.onErrorAdList.length)for(var i=0;i<STATIC.onErrorAdList.length;i+=1)"function"==typeof STATIC.onErrorAdList[i]&&STATIC.onErrorAdList[i].call(this,p)},PUBLIC_STATIC.setup=function(obj){var promise=new Promise(function(resolve,reject){return!obj||obj.tgmKey?void reject("Invalid tgmkey"):void PRIVATE.setup(obj).then(function(){resolve()},function(){reject()})});return promise},PUBLIC_STATIC.overrideAdMetadata=function(area,data){var ads=PUBLIC_STATIC.getAds();if(ads[area]){STATIC.log.write("[WARN] Override ad metadata ["+area+"]");for(var i in data)ads[area][i]=data[i];return ads[area]}STATIC.log.write("[ERROR] Override ad metadata ["+area+"] failed. The area provided probably does not exist")},PUBLIC_STATIC.reload=function(placeholderId){if(!placeholderId||"string"!=typeof placeholderId||"object"!=typeof STATIC.pageAds[placeholderId])throw new Error("Invalid placeholder id to reload");var conf=STATIC.pageAds[placeholderId];return new Promise(function(resolve,reject){var elem=document.getElementById(conf.placeholder),wrapper=document.getElementById(conf.placeholder+"--wrapper");elem?(conf.sizes=[conf.width,conf.height],elem.style&&elem.offsetHeight&&wrapper&&(wrapper.style.height=elem.offsetHeight+"px",setTimeout(function(){wrapper.style.height="auto"},1500)),conf.reloaded=!0,PRIVATE.render(conf,function(_data){resolve({data:_data,message:"Ad "+conf.placeholder+" successfully reloaded"})})):reject("Invalid ad placeholder")})},PUBLIC_STATIC.reloadAll=function(){return new Promise(function(resolve,reject){var ads=PUBLIC_STATIC.getAds(),ps=[],success=function(data){return data},error=function(e){return e};for(var i in ads)"string"==typeof ads[i].reloadRule&&(ads[i].reloadRule=JSON.parse(ads[i].reloadRule)),ads[i].reloadRule&&ads[i].reloadRule.reload===!0&&"all"===ads[i].reloadRule.type&&(STATIC.log.write("[INFO] Reloading ad "+ads[i].placeholder),ps.push(PUBLIC_STATIC.reload(ads[i].placeholder).then(success,error)));ps.length>0?Promise.all(ps).then(function(data){resolve(data)},function(e){reject(e)}):reject("I can't find any ad to be reloaded")})},PUBLIC_STATIC.getAds=function(){return STATIC.viewportAds},PUBLIC_STATIC.calcViewportN=function(n){var orderArray=PRIVATE.settings.VIEWPORT_ORDER,viewportMax=PRIVATE.settings.VIEWPORT_MAX;return n&&"number"==typeof n?viewportMax>=n?n:orderArray[PRIVATE.calcViewportN(n)]:!1},PUBLIC_STATIC.version=require("./lib/version"),window.AdManager=PUBLIC_STATIC,PRIVATE.startEvents(),"object"==typeof window.zaz&&"function"==typeof zaz.use&&zaz.use(function(pkg){try{pkg.define("mod.adManager",[],function(){return PUBLIC_STATIC})}catch(e){window.console&&window.console.warn&&window.console.warn('Exception registering "mod.adManager" on ZaZ Includer: '+e.message)}})}()},{"./lib/fif/fif":2,"./lib/log/log":3,"./lib/native-filters/native-filters":4,"./lib/promise/promise":5,"./lib/util/util":6,"./lib/version":7}]},{},[8]);